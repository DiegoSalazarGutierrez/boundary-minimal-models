\documentclass[a4paper, 12pt, reqno]{amsart}

\usepackage{amssymb}
\usepackage[backref = page]{hyperref}
\usepackage[margin = 0.75in]{geometry}
\usepackage[shortlabels]{enumitem}
\usepackage{tikz-cd}
\usepackage[nameinlink]{cleveref}

\newtheorem{theorem}{Theorem}[section]
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{corollary}[theorem]{Corollary}

\theoremstyle{remark}
\newtheorem{remark}[theorem]{Remark}
\newtheorem{example}[theorem]{Example}

\setenumerate[0]{label = \normalfont(\roman*)}

\DeclareMathOperator{\Vir}{Vir}
\DeclareMathOperator{\Ind}{Ind}
\DeclareMathOperator{\ch}{ch}
\DeclareMathOperator{\len}{len}
\DeclareMathOperator{\vac}{|0\rangle}
\DeclareMathOperator{\gr}{gr}
\DeclareMathOperator{\Hom}{Hom}
\DeclareMathOperator{\vspan}{span}
\DeclareMathOperator{\supp}{supp}
\DeclareMathOperator{\ad}{ad}
\DeclareMathOperator{\lp}{lp}
\DeclareMathOperator{\prt}{prt}
\DeclareMathOperator{\res}{res}
\DeclareMathOperator{\Der}{Der}
\DeclareMathOperator{\End}{End}
\DeclareMathOperator{\Id}{Id}
\DeclareMathOperator{\fs}{fs}

\renewcommand*{\backref}[1]{}
\renewcommand*{\backrefalt}[4]{%
  \ifcase #1 (Not cited.)%
  \or        (Cited on page~#2.)%
  \else      (Cited on pages~#2.)%
  \fi}

\begin{document}

\setcounter{section}{-1}

\begin{abstract}
  Some abstract. \\
  \smallskip
  \noindent \textbf{Keywords.} Some keywords.
\end{abstract}

\title{Boundary minimal models}
\author{Diego Salazar}
\address{Instituto de Matemática Pura e Aplicada, Rio de Janeiro, RJ, Brazil}
\email{diego.salazar@impa.br}
\date{\today}
\maketitle

\section{Introduction}
\label{sec:introduction}

Let $s \in \mathbb{Z}_+$, let $i \in \{1, 2, \dots, s\}$, let $R^{s, i}$ denote the following set of partitions
\begin{equation*}
  R^{s, i} = \{\text{$\lambda$ is a partition} \mid \text{$\lambda = [\lambda_1, \dots, \lambda_s]$ satisfies $\lambda_1 - \lambda_s \le 1$ or $\lambda = \underbrace{[1, 1, \dots, 1]}_i$}\},
\end{equation*}
and let $P^{s, i}$ be the set of partitions that do not contain any partition in $R^{s, i}$.

\begin{theorem}
  \label{thr:1}
  With notation as above, we have
  \begin{equation}
    \label{eq:2}
    \ch_{L(c_{2, 2s + 1}, h_{1, i})}(t, q) = h^{1, i}J_{s, i}(0, t, q) = h^{1, i}\left(\sum_{k = (k_1, \dots, k_{s - 1}) \in \mathbb{N}^{s - 1}}t^{kB^{(s)}_{s - 1}}\frac{q^{\frac{1}{2}kG^{(s)}k^T + kB^{(s)}_{s - i}}}{(q)_{k_1}\dots(q)_{k_{s - 1}}}\right),
  \end{equation}
  where $T$ denotes the transpose matrix and
  \begin{align*}
    G^{(s)} &= (2\min\{i, j\})_{i, j = 1}^{s - 1}, \\
    B^{(s)}_j &=
                \left(\begin{smallmatrix}
                  0 \\
                  0 \\
                  \vdots \\
                  0 \\
                  1 \\
                  2 \\
                  \vdots \\
                  j
                \end{smallmatrix}\right) \quad \text{for $j = 0, 1, \dots, s - 1$}.  
  \end{align*}
\end{theorem}

\begin{theorem}
  \label{thr:2}
  The set
  \begin{equation*}
    \{L_{-\lambda_1}L_{-\lambda_2}\dots L_{-\lambda_m}|c_{2, 2s + 1}, h_{1, i}\rangle \mid \lambda = [\lambda_1, \dots, \lambda_m] \in P^{s, i}\}
  \end{equation*}
  is a vector space basis of $L(c_{2, 2s + 1}, h_{1, i})$. 
\end{theorem}

\begin{theorem}
  \label{thr:3}
  The boundary minimal models $L(c_{2, 2s + 1}, h_{1, i})$ are classically free for $s \in \mathbb{Z}_+$ and $i \in \{1, \dots, s\}$.
\end{theorem}

\section{Preliminaries and notation}
\label{sec:prel-notat}

The set of natural numbers $\{0, 1, \dots\}$ is denoted by $\mathbb{N}$, the set of integers is denoted by $\mathbb{Z}$, and the set of positive integers $\{1, 2, \dots\}$ is denoted by $\mathbb{Z}_+$.

First, we review the theory of representations of the Virasoro Lie algebra following \cite{kac_bombay_2013}.
The \emph{Virasoro Lie algebra} is a Lie algebra given by
\begin{equation*}
  \Vir = \bigoplus_{n \in \mathbb{Z}}\mathbb{C}L_n \oplus \mathbb{C}C.
\end{equation*}
These elements satisfy the following commutation relations:
\begin{equation}
  \label{eq:53}
  \begin{split}
    [L_m, L_n] &= (m - n)L_{m + n} + \delta_{m, -n}\frac{m^3 - m}{12}C \quad \text{for $m, n \in \mathbb{Z}$}, \\
    [\Vir, C] &= 0.
  \end{split}
\end{equation}
Let $c, h \in \mathbb{C}$.
We set $\Vir^{\ge} = \bigoplus_{n \in \mathbb{N}}\mathbb{C}L_n \oplus \mathbb{C}C$.
We make the subalgebra $\Vir^{\ge}$ of $\Vir$ act on $\mathbb{C}$ as follows:
\begin{equation*}
  \text{$L_n1 = 0$ for $n \in \mathbb{Z}_+$, $L_01 = h$ and $C1 = c$}.
\end{equation*}
The \emph{Verma representation} of $\Vir$ with \emph{highest weight} $(c, h)$ is defined as
\begin{equation*}
  M(c, h) = \Ind^{\Vir}_{\Vir^{\ge}}(\mathbb{C}) = U(\Vir) \otimes_{U(\Vir^{\ge})} \mathbb{C},
\end{equation*}
where $\Vir$ acts by left multiplication.
We take $|c, h\rangle = 1 \otimes 1$ as \emph{highest weight vector}.

A \emph{composition (of $n \in \mathbb{N}$)} is a sequence $\lambda = [\lambda_1, \dots, \lambda_m]$ such that $\lambda_i \in \mathbb{Z}_+$ for $i = 1, \dots, m$ (and $\lambda_1 + \dots + \lambda_m = n$).
We also consider the \emph{empty composition} $\emptyset$, which is the unique composition of $0$.
Given a composition $\lambda = [\lambda_1, \dots, \lambda_m]$ and a permutation $\sigma \in S_m$, we define the composition
\begin{equation*}
  \lambda\sigma = [\lambda_{\sigma(1)}, \dots, \lambda_{\sigma(m)}].
\end{equation*}

For a composition $\lambda = [\lambda_1, \dots, \lambda_m]$, we define
\begin{equation*}
  L_{\lambda} = L_{-\lambda_1}\dots L_{-\lambda_m} \in U(\Vir),
\end{equation*}
the \emph{length of $\lambda$} as
\begin{equation*}
  \len(\lambda) = m,
\end{equation*}
the \emph{weight of $\lambda$} as
\begin{equation*}
  \Delta(\lambda) = \lambda_1 + \dots + \lambda_m,
\end{equation*}
and
\begin{equation*}
  p_{\lambda} = L_{-\lambda_1}\dots L_{-\lambda_m} \in \mathbb{C}[L_{-1}, L_{-2}, \dots].
\end{equation*}

A \emph{partition (of $n \in \mathbb{N}$)} is a composition $\lambda = [\lambda_1, \dots, \lambda_m]$ (of $n$) such that $\lambda_1 \ge \dots \ge \lambda_m$.
The notation $\lambda \vdash$ means $\lambda$ is a partition, and for $n \in \mathbb{N}$, the notation $\lambda \vdash n$ means $\lambda$ is a partition of $n$.
This notation also tacitly assumes that $\lambda$ is a partition and not just a composition.

Given a composition $\lambda$ of length $m$, there is a unique partition $\prt(\lambda)$ obtained by reordering $\lambda$, i.e., by considering all $\lambda\sigma$ for $\sigma \in S_m$.

By the PBW theorem, the set
\begin{equation*}
  \{L_{\lambda}|c, h\rangle \mid \lambda \vdash\}
\end{equation*}
is a vector space basis of $M(c, h)$.
The representation $M(c, h)$ has a unique maximal proper subrepresentation $J(c, h)$, and the quotient
\begin{equation*}
  L(c, h) = M(c, h)/J(c, h)
\end{equation*}
is the \emph{irreducible highest weight representation} of $\Vir$ with highest weight $(c, h)$.

\section{Modules over algebras with a filtration}
\label{sec:modul-over-algebr}

Let $A$ be an associative (not necessarily commutative) algebra with unit $1$ and filtration $(A^p)_{p \in \mathbb{Z}}$ such that:
\begin{enumerate}
\item $A^p = 0$ for $p < 0$;
\item $1 \in A^0$;
\item $A^0 \subseteq A^1 \subseteq \dots$;
\item $A^pA^q \subseteq A^{p + q}$ for $p, q \in \mathbb{Z}$.
\end{enumerate}
Let
\begin{equation*}
  \gr(A) = \bigoplus_{p \in \mathbb{N}}A^p/A^{p - 1}
\end{equation*}
be the associated graded vector space.
The vector space $\gr(A)$ is an associative algebra with unit and multiplication given as follows.
For $p, q \in \mathbb{N}$, $a \in A^p$ and $b \in A^p$, we set
\begin{equation*}
  \gamma^p(a)\gamma^q(b) = \gamma^{p + q}(ab),
\end{equation*}
where $\gamma^p: A^p \to \gr(A)$ is the \emph{principal symbol map}, which is the composition of the natural maps $A^p \twoheadrightarrow A^p/A^{p - 1}$ and $A^p/A^{p - 1} \hookrightarrow \gr(A)$.
The unit of $\gr(A)$ is $\gamma^0(1)$.

Let $\partial$ be a derivation of $A$ respecting the grading $(A^p)_{p \in \mathbb{Z}}$, i.e., it satisfies:
\begin{enumerate}
\item $\partial(ab) = \partial(a)b + a\partial(b)$ for $a, b \in A$;
\item $\partial(A^p) \subseteq A^p$ for $p \in \mathbb{Z}$.
\end{enumerate}
We can define
\begin{align*}
  \partial: \gr(A) &\to \gr(A), \\
  \partial(\gamma^p(a)) &= \gamma^p(\partial(a)) \quad \text{for $p \in \mathbb{Z}$ and $a \in A^p$},
\end{align*}
and it is a derivation of $\gr(A)$.

\begin{example}
  \label{exa:1}
  Let $\mathfrak{g}$ be a Lie algebra.
  The \emph{PBW filtration of $U(\mathfrak{g})$}, the universal enveloping algebra of $\mathfrak{g}$, is given by
  \begin{equation*}
    U(\mathfrak{g})^p = \vspan\{x_1x_2\dots x_s \mid s \le p, x_1, \dots, x_s \in \mathfrak{g}\} \quad \text{for $p \in \mathbb{Z}$}.
  \end{equation*}
  This filtration clearly satisfies axioms (i)--(iv) above, and $\gr(U(\mathfrak{g}))$ is naturally isomorphic to $S(\mathfrak{g})$, the symmetric algebra of $\mathfrak{g}$, which is a polynomial algebra (see \cite[\S2]{dixmier_enveloping_1996} for details).
  Furthermore, if $\partial$ is a derivation of $\mathfrak{g}$ as a Lie algebra, then we can extend $\partial$ to a derivation of $U(\mathfrak{g})$, and it respects the PBW filtration.
  Thus, it defines a derivation $\partial: \gr(U(\mathfrak{g})) \to \gr(U(\mathfrak{g}))$.
\end{example}

Let $M$ be an $A$-module with filtration $(M^p)_{p \in \mathbb{Z}}$ such that:
\begin{enumerate}
\item $M^p = 0$ for $p < 0$;
\item $M^0 \subseteq M^1 \subseteq \dots$;
\item $A^pM^q \subseteq M^{p + q}$ for $p, q \in \mathbb{Z}$.
\end{enumerate}
Let
\begin{equation*}
  \gr(M) = \bigoplus_{p \in \mathbb{N}}M^p/M^{p - 1}
\end{equation*}
be the associated graded vector space.

Then $\gr(M)$ is a $\gr(A)$-module with operations given as follows.
For $p, q \in \mathbb{N}$, $a \in A^p$ and $u \in M^p$, we set
\begin{equation*}
  \gamma^p(a)\gamma^q_M(u) = \gamma^{p + q}_M(au),
\end{equation*}
where $\gamma^p_M: M^p \to \gr(M)$ is the \emph{principal symbol map}, which is the composition of the natural maps $M^p \twoheadrightarrow M^p/M^{p - 1}$ and $M^p/M^{p - 1} \hookrightarrow \gr(M)$.

The category of modules over $A$ with the given filtration $(A^p)_{p \in \mathbb{Z}}$ is given by modules $M$ with filtration $(M^p)_{p \in \mathbb{Z}}$ satisfying the conditions above.
A homomorphism $f: M \to N$ must satisfy $f(M^p) \subseteq N^p$ for $p \in \mathbb{Z}$.
This category is denoted by $A$-Mod (the filtration being suppressed from the notation).

We define a functor $\gr: \text{$A$-Mod} \to \text{$\gr(A)$-Mod}$ as follows.
For a homomorphism $f: M \to N$, we set
\begin{align*}
  \gr(f): \gr(M) &\to \gr(N), \\
  \gr(f)(\gamma_M^p(u)) &= \gamma_N^p(f(u)) \quad \text{for $p \in \mathbb{N}$ and $u \in M^p$}.
\end{align*}

From now on, some subscripts or superscripts will be omitted, so for example $\gamma^p_M$ simplifies to $\gamma^p$.

\section{Modules over $Q$-graded Lie algebras}
\label{sec:modules-over-q}

In this section, we follow \cite[\S2]{iohara_representation_2011}.
Let $\Gamma$ be an abelian group.
For a $\Gamma$-graded vector space $V = \bigoplus_{\alpha \in \Gamma}V^{\alpha}$, we set $\supp(V) = \{\alpha \in \Gamma \mid V^{\alpha} \neq 0\}$.

A \emph{$\Gamma$-graded Lie algebra} is a Lie algebra $\mathfrak{g} = \bigoplus_{\alpha \in \Gamma}\mathfrak{g}^{\alpha}$ such that
\begin{equation*}
  [\mathfrak{g}^{\alpha}, \mathfrak{g}^{\beta}] \subseteq \mathfrak{g}^{\alpha + \beta} \quad \text{for $\alpha, \beta \in \Gamma$}.
\end{equation*}

Let $Q$ be a free abelian group of finite rank $r$, and let $\mathfrak{g}$ be a Lie algebra with a commutative subalgebra $\mathfrak{h}$.
We say a pair $(\mathfrak{g}, \mathfrak{h})$ is a \emph{$Q$-graded Lie algebra} if it satisfies the following:
\begin{enumerate}
\item $\mathfrak{g} = \bigoplus_{\alpha \in Q}\mathfrak{g}^{\alpha}$ is $Q$-graded, $\mathfrak{h} = \mathfrak{g}^0$, and $\supp(\mathfrak{g})$ generates $Q$;
\item We have a homomorphism $\pi_Q: Q \to \mathfrak{h}^*, \alpha \mapsto \lambda_{\alpha}$ such  that
  \begin{equation*}
    [h, x] = \lambda_{\alpha}(h)x \quad \text{for $h \in \mathfrak{h}$ and $x \in \mathfrak{g}^{\alpha}$};
  \end{equation*}
\item For $\alpha \in Q$, $\dim(\mathfrak{g}^{\alpha}) < \infty$;
\item There exists a basis $(\alpha_i)_{i = 1}^r$ of $Q$ such that for $\alpha \in \supp(\mathfrak{g})$,
  \begin{equation*}
    \text{$\alpha \in \sum_{i = 1}^r\mathbb{Z}_{\ge 0}\alpha_i$ or $\alpha \in \sum_{i = 1}^r\mathbb{Z}_{\le 0}\alpha_i$}.
  \end{equation*}
\end{enumerate}

The condition (iv) implies that a $Q$-graded Lie algebra admits a \emph{triangular decomposition}
\begin{equation*}
  \mathfrak{g} = \mathfrak{g}^- \oplus \mathfrak{h} \oplus \mathfrak{g}^+,
\end{equation*}
where $Q^+ = \sum_{i = 1}^r\mathbb{Z}_{\ge 0}\alpha_i$ and
\begin{equation*}
  \mathfrak{g}^{\pm} = \bigoplus_{\pm \alpha \in Q^+ \setminus \{0\}}\mathfrak{g}^{\alpha}.
\end{equation*}
For later use, we set $\mathfrak{g}^{\ge} = \mathfrak{h} \oplus \mathfrak{g}^+$ and $\mathfrak{g}^{\le} = \mathfrak{g}^- \oplus \mathfrak{h}$.

\begin{example}[\emph{$\Vir$ as a $\mathbb{Z}$-graded Lie algebra}]
  \label{exa:2}
  We set $Q = \mathbb{Z}$, $\mathfrak{h} = \mathbb{C}L_0 \oplus \mathbb{C}C$, $\Vir^n = \mathbb{C}L_n$ for $n \in \mathbb{Z} \setminus \{0\}$ and
  \begin{align*}
    \pi_Q: Q &\to \mathfrak{h}^*, \\
    \pi_Q(n) &= (L_0 \mapsto -n, C \mapsto 0).
  \end{align*}
  Then $(\Vir, \mathfrak{h})$ is readily seen to be a $\mathbb{Z}$-graded Lie algebra.
  We take $1$ as the basis of $Q$, so $Q^+ = \mathbb{N}$.
  We can verify that $\ad(L_{-1})$ is a derivation of $\Vir$ satisfying $\ad(L_{-1})(\Vir^-) \subseteq \Vir^-$.
  Therefore, $\gr(\Vir^-) \cong \mathbb{C}[L_{-1}, L_{-2}, \dots]$ has a derivation given by $\partial(L_{-n}) = (n - 1)L_{-n - 1}$.
\end{example}

\begin{example}[\emph{(Untwisted) affinization of $\mathfrak{g}$}]
  \label{exa:7}
  Let $\mathfrak{g}$ be a finite dimensional Lie algebra over $\mathbb{C}$, let $\mathfrak{h}$ be a Cartan subalgebra of $\mathfrak{g}$, and let $(\bullet, \bullet)$ be a nondegenerate invariant bilinear form on $\mathfrak{g}$.
  We set:
  \begin{align*}
    \bar{\mathfrak{g}} &= \mathfrak{g} \otimes \mathbb{C}[t, t^{-1}] \oplus \mathbb{C}K \oplus \mathbb{C}d, \\
    [xt^m, yt^n] &= [x, y]t^{m + n} + m\delta_{m, -n}(x, y)K \quad \text{for $x, y \in \mathfrak{g}$ and $m, n \in \mathbb{Z}$},  \\
    [K, \bar{\mathfrak{g}}] &= 0, \\
    [d, xt^m] &= mxt^m \quad \text{for $x \in \mathfrak{g}$ and $m \in \mathbb{Z}$}.
  \end{align*}
  With this bracket, $\bar{\mathfrak{g}}$ becomes a Lie algebra called the \emph{(untwisted) affine Lie algebra of $\mathfrak{g}$} or the \emph{(untwisted) affinization of $\mathfrak{g}$}.
  If $\mathfrak{g}$ is simple, $\bar{\mathfrak{g}}$ is called the \emph{(untwisted) Kac-Moody affinization of $\mathfrak{g}$}.

  Let $\Delta \subseteq \mathfrak{h}^*$ be the set of roots of $\mathfrak{g}$ with respect to $\mathfrak{h}$, so we have a root space decomposition $\mathfrak{g} = \mathfrak{h} \bigoplus_{\beta \in \Delta}\mathfrak{g}^{\beta}$, where $\mathfrak{g}^{\beta} = \{x \in \mathfrak{g} \mid \text{for $h \in \mathfrak{h}$, $[h, x] = \beta(h)x$}\}$ for $\beta \in \mathfrak{h}^*$.
  We fix a set of simple roots $(\alpha_i)_{i = 1}^r$ of $\mathfrak{g}$ and denote the highest root by $\theta$.

  We set
  \begin{equation*}
    \bar{\mathfrak{h}} = \mathfrak{h}t^0 \oplus \mathbb{C}K \oplus \mathbb{C}d
  \end{equation*}
  and for $\beta \in \mathfrak{h}^*$, we extend $\beta$ by defining $\bar{\beta} \in \bar{\mathfrak{h}}^*$ as follows
  \begin{align*}
    \bar{\beta}: \bar{\mathfrak{h}}^* &\to \mathbb{C}, \\
    \bar{\beta}(ht^0) &= \beta(h) \quad \text{for $h \in \mathfrak{h}$}, \\
    \bar{\beta}(K) = \bar{\beta}(d) &= 0.
  \end{align*}
  We get a new set of roots $\bar{\Delta} \subseteq \bar{\mathfrak{h}}^*$ given by
  \begin{equation*}
    \bar{\Delta} = \{\bar{\beta} \mid \beta \in \Delta\},
  \end{equation*}
  and we define one more root $\delta \in \bar{\mathfrak{h}}^*$ by setting
  \begin{align*}
    \delta: \bar{\mathfrak{h}} &\to \mathbb{C}, \\
    \delta(\mathfrak{h}t^0) &= 0, \\
    \delta(K) &= 0, \\
    \delta(d) &= 1.
  \end{align*}
  Finally, we set
  \begin{equation*}
    Q = \mathbb{Z}\bar{\Delta} \oplus \mathbb{Z}\delta \subseteq \bar{\mathfrak{h}}^*
  \end{equation*}
  and for $\alpha \in Q$, 
  \begin{equation*}
    \bar{\mathfrak{g}}^{\alpha} =
    \begin{cases}
      \mathfrak{g}^{\beta}t^n &\text{if $\alpha = \bar{\beta} + n\delta$ for some $\bar{\beta} \in \bar{\Delta}$ and $n \in \mathbb{Z}$}; \\
      \mathfrak{h}t^n &\text{if $\alpha = n\delta$ for some $n \in \mathbb{Z} \setminus \{0\}$}; \\
      \mathfrak{h} &\text{if $\alpha = 0$}; \\
      0 &\text{otherwise}.
    \end{cases}
  \end{equation*}
  Then $\bar{\mathfrak{g}} = \bigoplus_{\alpha \in Q}\bar{\mathfrak{g}}^{\alpha}$ is the root space decomposition with respect to $\bar{\mathfrak{h}}$, and $\Pi = \{\alpha_1, \dots, \alpha_r\} \cup \{\alpha_0\}$ is a $\mathbb{Z}$-basis of $Q$ satisfying (iv), where $\pi_Q$ is the inclusion map and $\alpha_0 = \delta - \theta$.
  Hence, $(\mathfrak{g}, \mathfrak{h})$ is a $Q$-graded Lie algebra.
\end{example}

\begin{example}[\emph{Affinization of $\mathfrak{g}$}]
  \label{exa:8}
  With notation as in the last example, we set
  \begin{equation*}
    \hat{\mathfrak{g}} = [\bar{\mathfrak{g}}, \bar{\mathfrak{g}}] = \mathfrak{g} \otimes \mathbb{C}[t, t^{-1}] \oplus \mathbb{C}K.
  \end{equation*}
  With this bracket, $\hat{\mathfrak{g}}$ becomes a Lie algebra called the \emph{affine Lie algebra of $\mathfrak{g}$} or the \emph{affinization of $\mathfrak{g}$}.
  If $\mathfrak{g}$ is simple, $\hat{\mathfrak{g}}$ is called the \emph{Kac-Moody affinization of $\mathfrak{g}$}.

  We set
  \begin{equation*}
    \hat{h} = \bar{\mathfrak{h}} \cap \hat{\mathfrak{g}} = \mathfrak{h}t^0 \oplus \mathbb{C}K.
  \end{equation*}
  Then $(\hat{\mathfrak{g}}, \hat{\mathfrak{h}})$ is a $Q$-graded Lie algebra with $Q$-grading
  \begin{equation*}
    (\hat{\mathfrak{g}})^{\alpha} =
    \begin{cases}
      \bar{\mathfrak{g}}^{\alpha} &\text{if $\alpha \neq 0$}; \\
      \hat{\mathfrak{h}} &\text{if $\alpha = 0$}.
    \end{cases}
  \end{equation*}
  In this case, the map $\pi_Q: Q \to (\mathfrak{h}')^*$ is not injective because $\pi_Q(\delta) = 0$.
\end{example}

Let $\Gamma$ be an abelian group, and let $\mathfrak{g} = \bigoplus_{\alpha \in \Gamma}\mathfrak{g}^{\alpha}$ be a $\Gamma$-graded Lie algebra.
A $\mathfrak{g}$-module $M = \bigoplus_{\alpha \in \Gamma}M^{\alpha}$ is \emph{$\Gamma$-graded} if
\begin{equation*}
  \mathfrak{g}^{\alpha}M^{\beta} \subseteq M^{\alpha + \beta} \quad \text{for $\alpha, \beta \in \Gamma$}.
\end{equation*}

An $\mathfrak{h}$-module $M$ is \emph{$\mathfrak{h}$-diagonalizable} if
\begin{equation*}
  M = \bigoplus_{\lambda \in \mathfrak{h}^*}M_{\lambda},
\end{equation*}
where
\begin{equation*}
  M_{\lambda} = \{u \in M \mid \text{for $h \in \mathfrak{h}$, $hu = \lambda(h)u$}\}.
\end{equation*}

An $\mathfrak{h}$-diagonalizable module $M$ is called \emph{$\mathfrak{h}$-semisimple} if
\begin{equation*}
  \dim(M_{\lambda}) < \infty \quad \text{for $\lambda \in \mathfrak{h}^*$}.
\end{equation*}
A $(\mathfrak{g}, \mathfrak{h})$-module is an $\mathfrak{h}$-diagonalizable $\mathfrak{g}$-module.
From now on, we assume that $\pi_Q$ is injective.

The \emph{character of a semisimple $(\mathfrak{g}, \mathfrak{h})$-module $M$} is given by
\begin{equation*}
  \ch_M(q) = \sum_{\lambda \in \mathfrak{h}^*}\dim(M_{\lambda})q^{\lambda}.
\end{equation*}

We can regard $\mathfrak{g}$ as a $(\mathfrak{g}, \mathfrak{h})$-module via the adjoint representation and by declaring for $\lambda \in \mathfrak{h}^*$,
\begin{equation*}
  \mathfrak{g}_{\lambda} = \mathfrak{g}^{\alpha} \quad \text{if there exists $\alpha \in Q$ such that $\lambda = \pi_Q(\alpha)$}.
\end{equation*}
This construction assumes implicitly that $\pi_Q$ is injective.

The category $\mathcal{C}_{(\mathfrak{g}, \mathfrak{h})}$ is the category whose objects are $\mathfrak{h}^*$-graded $(\mathfrak{g}, \mathfrak{h})$-modules and for $M, N \in \mathcal{C}_{(\mathfrak{g}, \mathfrak{h})}$, $\Hom_{\mathcal{C}_{(\mathfrak{g}, \mathfrak{h})}}(M, N) = \Hom_{\mathfrak{g}}(M, N)$ (Lie algebra module homomorphisms).

\begin{remark}
  \label{rmk:1}
  If $f \in \Hom_{\mathfrak{g}}(M, N)$, then $f$ respects the $\mathfrak{h}^*$-grading automatically because for $u \in M$ and $h \in \mathfrak{h}$, $hf(u) = f(hu) = f(\lambda(h)u) = \lambda(h)f(u)$.
\end{remark}

We can introduce a partial order on $Q$ as follows
\begin{equation*}
  \lambda_1 \le \lambda_2 \iff \text{there exists $\gamma \in Q^+$ such that $\lambda_2 - \lambda_1 = \pi_Q(\gamma)$.}
\end{equation*}
Since $\pi_Q$ is assumed to be injective, we can abuse notation and write $\lambda_2 - \lambda_1 = \gamma \in Q$.

We now define the full subcategory $\mathcal{C}^{\lambda \ge}_{(\mathfrak{g}, \mathfrak{h})}$ by considering the objects $M \in \mathcal{C}_{(\mathfrak{g}, \mathfrak{h})}$ such that $M_{\mu} = 0$ if $\lambda \ngeq \mu$.

Let $(\mathfrak{g}, \mathfrak{h})$ be a $Q$-graded Lie algebra, let $M \in \mathcal{C}_{(\mathfrak{g}, \mathfrak{h})}$, and let $\lambda \in \mathfrak{h}^*$.
$M$ is called a \emph{highest weight module} with \emph{highest weight} $\lambda \in \mathfrak{h}^*$ if there is a nonzero vector $v \in M_{\lambda}$ such that:
\begin{enumerate}
\item $xv = 0$ for $x \in \mathfrak{g}^+$;
\item $U(\mathfrak{g}^-)v = M$.
\end{enumerate}
The vector $v$ is called a \emph{highest weight vector of $M$} and is unique up to multiplication by a nonzero scalar.

\begin{example}
  \label{exa:3}
  When considering the $\mathbb{Z}$-graded Virasoro Lie algebra $(\Vir, \mathfrak{h})$, where $\mathfrak{h} = \mathbb{C}L_0 \oplus \mathbb{C}C$, we identify $\mathfrak{h}^*$ with $\mathbb{C}^2$ as $\lambda = (c, h)$ if $\lambda(C) = c$ and $\lambda(L_0) = h$.
  We are mainly interested in the highest weight modules $M(c, h)$ and $L(c, h)$ of the Virasoro Lie algebra.
  In this case, $(c_2, n_2) \ge (c_1, n_1)$ if and only if $c_1 = c_2$ and $n_1 \ge n_2$.
  If this happens, $(c_2, n_2) - (c_1, n_1) = n_1 - n_2$.
\end{example}

\section{The refined character}
\label{sec:refined-character}

Let $(\mathfrak{g}, \mathfrak{h})$ be a $\mathbb{Z}$-graded Lie algebra, let $\lambda \in \mathfrak{h}^*$, and let $M \in \mathcal{C}^{\lambda \ge}_{(\mathfrak{g}, \mathfrak{h})}$ be a semisimple module.
The \emph{PBW filtration of $M$} is given by
\begin{equation*}
  M^p = \{au \mid q \in \mathbb{N}, \mu \le \lambda, a \in U(\mathfrak{g}^-)^q, u \in M_{\mu}, q + \lambda - \mu \le p\} \quad \text{for $p \in \mathbb{Z}$}.
\end{equation*}
This filtration clearly satisfies axioms (i)--(iii) above with $U(\mathfrak{g}^-)$ in place of $A$, and $\gr(M)$ becomes a $\gr(U(\mathfrak{g^-}))$-module.

If $f: M \to N$ is a homomorphism, where $M, N \in \mathcal{C}^{\lambda \ge}_{(\mathfrak{g}, \mathfrak{h})}$, then
\begin{align*}
  \gr(f): \gr(M) &\to \gr(N), \\
  \gr(f)(\gamma_M^p(u)) &= \gamma_N^p(f(u)) \quad \text{for $p \in \mathbb{N}$ and $u \in M^p$}
\end{align*}
defines a homomorphism of $\gr(U(\mathfrak{g}^-))$-modules.
Therefore, we obtain a functor
\begin{equation*}
  \gr: \mathcal{C}^{\lambda \ge}_{(\mathfrak{g}, \mathfrak{h})} \to \gr(U(\mathfrak{g}^-))\text{-Mod}.
\end{equation*}

\begin{remark}
  \label{rmk:2}
  Let $M, N \in \mathcal{C}^{\lambda \ge}_{(\mathfrak{g}, \mathfrak{h})}$, and let $f: M \to N$ be a homomorphism.
  By \Cref{rmk:1}, $f$ respects the $\mathfrak{h}^*$-grading, and this implies $f(M^p) \subseteq N^p$, so what we wrote above makes sense.
\end{remark}

\begin{example}
  \label{exa:4}
  Let $(c, h)$ be a highest weight.
  By \cite[\S2]{dixmier_enveloping_1996}, we have a natural isomorphism
  \begin{align*}
    \gr(M(c, h)) &\xrightarrow{\sim} \mathbb{C}[L_{-1}, L_{-2}, \dots] \cong \gr(U(\Vir^{-})), \\
    \gamma^{\len(\lambda)}(L_{\lambda}|c, h\rangle) & \mapsto p_{\lambda} \quad \text{for $\lambda$ a composition}.
  \end{align*}
  Therefore, the study of $M(c, h)$ and $L(c, h)$ essentially reduces to the study of polynomial algebras in $\mathbb{N}$-many variables, their ideals and quotients.
  Modules over these algebras do not play a significant role in this context.
\end{example}

The \emph{refined character of $M \in \mathcal{C}^{\lambda \ge}_{(\mathfrak{g}, \mathfrak{h})}$}, where $M$ is semisimple, is defined by
\begin{equation*}
  \ch_M(t, q) = \sum_{p \in \mathbb{N}}\sum_{\lambda \in \mathfrak{h}^*}\dim(\gamma^p(M^p \cap M_{\lambda}))t^pq^{\lambda},
\end{equation*}
and this is what we are interested in this article.
Clearly, we have
\begin{equation*}
  \ch_M(1, q) = \ch_M(q).
\end{equation*}

\begin{example}
  \label{exa:5}
  We can consider the $\mathbb{Z}$-graded Virasoro Lie algebra $(\Vir, \mathfrak{h})$.
  We are mainly interested in $M(c, h)$ and $L(c, h)$ for some highest weights $(c, h)$.
  For the Verma representation $M(c, h)$, we have
  \begin{equation*}
    \ch_{M(c, h)}(t, q) = \frac{q^h}{\prod_{k \in \mathbb{Z}_+}(1 - tq^k)}.
  \end{equation*}
\end{example}

\begin{example}
  \label{exa:6}
  In \cite{andrews_singular_2022}, the refined character of the Virasoro minimal model $\Vir_{3, 4} = L(1/2, 0)$, also known as the Ising model, is computed explicitly.
  Interestingly, this character is connected to Nahm sums for the matrix $\left(\begin{smallmatrix} 8 & 3 \\ 3 & 2 \end{smallmatrix}\right)$ (see \cite{Nahm2007}) and can be explicitly expressed as
  \begin{equation*}
    \ch_{L(1/2, 0)}(t, q) = \sum_{k_1, k_2 \in \mathbb{N}}t^{4k_1 + 2k_2}\frac{q^{4k_1^2 + 3k_1k_2 + k_2^2}}{(q)_{k_1}(q)_{k_2}}(1 - q^{k_1} + q^{k_1 + k_2}),
  \end{equation*}
  where $(q)_k = \prod_{j = 1}^k(1 - q^j) \in \mathbb{C}[q]$ denotes the \emph{$q$-Pochhammer symbol}.
\end{example}

\begin{remark}
  \label{rmk:3}
  Let $V$ be an $\mathbb{N}$-graded conformal vertex algebra, and let $M$ be an $h + \mathbb{N}$-graded $V$-module.
  It is worth noting that the PBW filtration $(M^p)_{p \in \mathbb{Z}}$ and the standard filtration $(G^pM)_{p \in \mathbb{Z}}$, as introduced in \cite{salazar_pbw_2024}, are different.
  Therefore, the associated graded objects $\gr(M)$ and $\gr^G(M)$ and the refined characters $\ch_M(t, q)$ and $\ch_{\gr^G(M)}(t, q)$ are both different.
  For example, for a highest weight $(c, h)$,
  \begin{equation*}
    \ch_{\gr^G(M(c, h))}(t, q) = \frac{q^h}{(1 - tq)\prod_{k \ge 2}(1 - t^2q^k)}.
  \end{equation*}
\end{remark}

Let $(c, h)$ be a highest weight.
We have a natural epimorphism
\begin{align*}
  \pi_{c, h}: M(c, h) &\twoheadrightarrow L(c, h), \\
  \pi_{c, h}(u) &= u + J(c, h),
\end{align*}
and it satisfies $\ker(\pi_{c, h}) = J(c, h)$.
Applying the functor $\gr$, we obtain an epimorphism of modules over $\gr(\Vir^-)$
\begin{equation*}
  \gr(\pi_{c, h}): \gr(M(c, h)) \twoheadrightarrow \gr^G(L(c, h)),
\end{equation*}
and this produces a natural isomorphism of modules over $\gr(\Vir^{-})$
\begin{equation*}
  \gr(M(c, h))/K(c, h) \xrightarrow{\sim} \gr(L(c, h)),
\end{equation*}
where
\begin{equation}
  \label{eq:5}
  K(c, h) = \ker(\gr(\pi_{c, h})).
\end{equation}
Explicitly, we have
\begin{equation}
  \label{eq:11}
  K(c, h) = \sum_{p \in \mathbb{N}}\gamma^p(J(c, h) \cap M(c, h)^p).
\end{equation}
From these observations, we obtain the following four isomorphisms which are going to be used frequently implicitly.

\begin{proposition}
  \label{prp:8}
  Let $(c, h)$ be a highest weight.
  We have four (conformal) weight-preserving vector space isomorphisms:
  \begin{align*}
    M(c, h) &\xrightarrow{\sim} \gr(M(c, h)), \\
    L_{\lambda}|c, h\rangle &\mapsto \gamma^{\len(\lambda)}(L_{\lambda}|c, h\rangle), \\
    \gr(M(c, h)) &\xrightarrow{\sim} \mathbb{C}[L_{-1}, L_{-2}, \dots], \\
    \gamma^{\len(\lambda)}(L_{\lambda}|c, h\rangle) &\mapsto p_{\lambda}, \\
    L(c, h) &\xrightarrow{\sim} \gr(L(c, h)), \\
    L_{\lambda}(|c, h\rangle + J(c, h)) &\mapsto \gamma^{\len(\lambda)}(L_{\lambda}(|c, h\rangle + J(c, h))), \\
    \gr(L(c, h)) &\xrightarrow{\sim} \gr(M(c, h))/K(c, h), \\
    \gamma^{\len(\lambda)}(L_{\lambda}(|c, h\rangle + J(c, h))) &\mapsto \gamma^{\len(\lambda)}(L_{\lambda}|c, h\rangle) + K(c, h),
  \end{align*}
  where $\lambda$ is a partition.
\end{proposition}

In this article, we will deal with the polynomial algebra $\mathbb{C}[L_{-1}, L_{-2}, \dots]$, its ideals and quotients.
We will always use the degree reverse lexicographic order with $L_{-1} > L_{-2} > \dots$.
Actually, we can only use Gröbner basis theory with finitely generated polynomial algebras like $\mathbb{C}[L_{-1}, L_{-2}, \dots, L_{-N}]$ for some $N \in \mathbb{N}$.
But taking $N \to \infty$, we can obtain our desired results, see \cite{salazar_pbw_2024} for details regarding this.

\section{A short survey on vertex algebras}
\label{sec:short-survey-vertex}

All vector spaces and all algebras are over $\mathbb{C}$, the field of complex numbers, unless otherwise stated.
The vector space of \emph{formal distributions in $n \in \mathbb{N}$ variables}, denoted by $\mathbb{C}[[x_1^{\pm 1}, \dots, x_n^{\pm 1}]]$, is the set of functions $f: \mathbb{Z}^n \to \mathbb{C}$, written as $f(x_1, \dots, x_n) = \sum_{m_1, \dots, m_n \in \mathbb{Z}}f_{m_1, \dots, m_n}x_1^{m_1}\dots x_n^{m_n}$, with the natural operations of addition and multiplication by a scalar.
The field of \emph{formal Laurent series}, denoted by $\mathbb{C}((x))$, is the subalgebra of elements $f(x) \in \mathbb{C}[[x^{\pm 1}]]$ such that there is $N \in \mathbb{Z}$ with $f_n = 0$ for $n \le N$.
If $V$ is a vector space, we similarly define $V[[x_1^{\pm 1}, \dots, x_n^{\pm 1}]]$ and $V((x))$, but in this case, $V((x))$ is only a vector space.

Let $V$ be a vector space.
The \emph{Fourier expansion of a formal distribution $a(z) \in V[[z^{\pm 1}]]$}, written as $a(z) = \sum_{n \in \mathbb{Z}}a_nz^n$, is conventionally written in the theory of vertex algebras as
\begin{equation*}
  a(z) = \sum_{n \in \mathbb{Z}}a_{(n)}z^{-n - 1},
\end{equation*}
where
\begin{equation*}
  a_{(n)} = a_{-n - 1}.
\end{equation*}
The \emph{residue of a formal distribution $a(z) \in V[[z^{\pm 1}]]$} is defined as
\begin{equation*}
  \res_z(a(z)) = a_{(0)} = a_{-1}.
\end{equation*}

Let $V$ be a vector space.
A formal distribution $a(z, w) \in V[[z^{\pm 1}, w^{\pm 1}]]$ is \emph{local} if there is $N \in \mathbb{N}$ such that
\begin{equation*}
  (z - w)^Na(z, w) = 0.
\end{equation*}

Let $\mathfrak{g}$ be a Lie algebra.
A subset $\mathfrak{F} \subseteq \mathfrak{g}[[z^{\pm 1}]]$ of formal distributions is called a \emph{local family} if all pairs of its elements are local.
Let $a(w)$ and $b(w)$ be two $\mathfrak{g}$-valued formal distributions.
For $n \in \mathbb{N}$, the \emph{$n$-product} is the $\mathbb{C}$-bilinear map defined by
\begin{align*}
  \bullet_{(n)}\bullet: \mathfrak{g}[[w^{\pm 1}]] \times \mathfrak{g}[[w^{\pm 1}]] &\to \mathfrak{g}[[w^{\pm 1}]], \\
  a(w)_{(n)}b(w) &= \res_z((z - w)^n[a(z), b(w)]).
\end{align*}

Let $\mathfrak{g}$ be a Lie algebra.
A \emph{formal distribution Lie algebra} is a pair $(\mathfrak{g}, \mathfrak{F})$, where $\mathfrak{F}$ is a local family of $\mathfrak{g}$-valued formal distributions, denoted by $\{a^j(z) = \sum_{n \in \mathbb{Z}}a^j_{(n)}z^{-n - 1}\}_{j \in J}$, such that the coefficients $\{a^j_{(n)} \mid j \in J, n \in \mathbb{Z}\}$ span the whole $\mathfrak{g}$.
A \emph{regular} formal distribution Lie algebra is a triple $(\mathfrak{g}, \mathfrak{F}, T)$ such that:
\begin{enumerate}
\item $(\mathfrak{g}, \mathfrak{F})$ is a formal distribution Lie algebra;
\item $\mathbb{C}[\partial_z]\mathfrak{F}$ is closed under all $n$-th products for $n \in \mathbb{N}$;
\item $T \in \Der(\mathfrak{g})$ satisfies
  \begin{equation*}
    T(a^j(z)) = \partial_za^j(z) \quad \text{for $j \in J$}.
  \end{equation*}
\end{enumerate}

Let $(\mathfrak{g}, \mathfrak{F})$ be a formal distribution Lie algebra.
The \emph{annihilation subalgebra of $(\mathfrak{g}, \mathfrak{F})$} is
\begin{equation*}
  \mathfrak{g}_- = \vspan\{a^j_{(n)} \mid j \in J, n \in \mathbb{N}\},
\end{equation*}
and the \emph{creation subalgebra of $(\mathfrak{g}, \mathfrak{F})$} is
\begin{equation*}
  \mathfrak{g}_+ = \vspan\{a^j_{(-n - 1)} \mid j \in J, n \in \mathbb{N}\}.
\end{equation*}

\begin{example}
  \label{exa:1}
  We construct a $\Vir$-valued formal distribution by setting
  \begin{equation*}
    \text{$L(z) = \sum_{n \in \mathbb{Z}}L_{(n)}z^{-n - 1}$ with $L_{(n)} = L_{n - 1}$ for $n \in \mathbb{Z}$}.
  \end{equation*}
  We usually write $L(z)$ as
  \begin{equation*}
    L(z) = \sum_{n \in \mathbb{Z}}L_nz^{-n - 2}.
  \end{equation*}
  By \cite[\S2]{frenkel_vertex_2001}, $\{L(z), C\}$ is a local family.
  Therefore, $(\Vir, \{L(z), C\})$ is a formal distribution Lie algebra.
  Moreover, we can verify directly that $(\Vir, \{L(z), C\}, \ad(L_{-1}))$ is regular.
\end{example}

\begin{example}
  \label{exa:2}
  Let $\mathfrak{g}$ be a finite dimensional Lie algebra, let $(\bullet, \bullet)$ be a nondegenerate invariant bilinear form on $\mathfrak{g}$, and let $\hat{\mathfrak{g}}$ be the affinization of $\mathfrak{g}$ as constructed in \Cref{exa:8}.
  We now construct $\hat{\mathfrak{g}}$-valued formal distributions by setting
  \begin{equation*}
    a(z) = \sum_{n \in \mathbb{Z}}at^nz^{-n - 1} \quad \text{for $a \in \mathfrak{g}$}.
  \end{equation*}
  By \cite[\S2]{frenkel_vertex_2001}, $\{a(z) \mid a \in \mathfrak{g}\} \cup \{K\}$ is a local family.
  Therefore, $(\hat{\mathfrak{g}}, \{a(z) \mid a \in \mathfrak{g}\} \cup \{K\})$ is a formal distribution Lie algebra.
  Moreover, we can verify directly that $(\hat{\mathfrak{g}}, \{a(z) \mid a \in \mathfrak{g}\} \cup \{K\}, -\partial_t)$ is regular.
\end{example}

Let $V$ be a vector space, and let $a(z) \in \End(V)[[z^{\pm 1}]]$ be a formal distribution.
We set
\begin{align*}
  a(z)_+ &= \sum_{n \le -1}a_{(n)}z^{-n - 1}, \\
  a(z)_- &= \sum_{n \ge 0}a_{(n)}z^{-n - 1}.
\end{align*}

A formal distribution $a(z)$ is a \emph{field} if
\begin{equation*}
  a(z)b = \sum_{n \in \mathbb{Z}}a_{(n)}bz^{-n - 1} \in V((z)) \quad \text{for $b \in V$}.
\end{equation*}
The vector space of fields over $V$ is denoted by $\mathcal{F}(V)$.
We note that
\begin{equation*}
  \mathcal{F}(V) = \Hom(V, V((z))).
\end{equation*}
Therefore, we can define a field $a(z)$ by defining $a(z)b \in V((z))$ for $b \in V$.

\begin{proposition}[{\cite[Proposition 3.3.2]{nozaradan_introduction_2008}}]
  \label{prp:6}
  Let $a(z), b(z) \in \mathcal{F}(V)$ be two fields.
  Then $:a(z)b(z): \in \End(V)[[z,z^{-1}]]$ is again a field, where $:a(z)b(z):$ is defined by
  \begin{equation*}
    :a(z)b(z):c = a(z)_+b(z)c + b(z)a(z)_-c \quad \text{for $c \in V$}.
  \end{equation*}
\end{proposition}

We thus defined the notion of \emph{normal ordered product between fields $a(z), b(z) \in \mathcal{F}(V)$}, denoted by $:a(z)b(z):$.
In general, the operation of normal ordered product is neither commutative nor associative.
We follow the convention that the normal ordered product is read from right to left, so that, by definition,
\begin{equation*}
  :a(z)b(z)c(z): = :a(z)(:b(z)c(z):):.
\end{equation*}
We define the normal ordered product of a single field as the field itself, and the normal ordered product of no fields as the identity field $\Id_V$, so we have:
\begin{align*}
  :a(z): &= a(z), \\
  :: &= \Id_V.
\end{align*}
The identity field $\Id_V$ acts as an identity for the normal ordered product, i.e.,
\begin{equation*}
  :\Id_Va(z): = :a(z)\Id_V: = a(z).
\end{equation*}

\begin{lemma}[{\cite[Proposition 3.3.3]{nozaradan_introduction_2008}}]
  \label{lmm:12}
  Let $V$ be a vector space, and let $a(z), b(z) \in \mathcal{F}(V)$ be fields.
  Their normal ordered product is written explicitly as
  \begin{equation*}
    :a(z)b(z): = \sum_{j \in \mathbb{Z}}:a(z)b(z):_{(j)}z^{-j - 1},
  \end{equation*}
  with
  \begin{equation*}
    :a(z)b(z):_{(j)}c = \sum_{n \le -1}a_{(n)}b_{(j - n - 1)}c + \sum_{n \ge 0}b_{(j - n - 1)}a_{(n)}c \quad \text{for $c \in V$}.
  \end{equation*}
\end{lemma}

\begin{lemma}
  \label{lmm:1}
  Let $V$ be a vector space.
  We consider $s$ fields $a^1(z), \dots, a^s(z) \in \mathcal{F}(V)$, with $s \ge 2$, and let $b \in V$.
  For $l \in \mathbb{Z}$,
  \begin{equation*}
    :a^1(z)a^2(z)\dots a^s(z):_{(l)}b = \sum_{n_1, \dots, n_{s - 1} \in \mathbb{N}}\sum_{k = 0}^{s - 1}R^{l, k}_{n_1, \dots, n_{s - 1}}(a^1(z), \dots, a^s(z))b,
  \end{equation*}
  where $R^{l, k}_{n_1, \dots, n_{s - 1}}(a^1(z), \dots, a^s(z))$ is the sum of $\binom{s - 1}{k}$ terms given by
  \begin{align*}
    &R^{l, k}_{n_1, \dots, n_{s - 1}}(a^1(z), \dots, a^s(z)) = \\
    &\sum_{\substack{1 \le i_1 < \dots < i_k \le s - 1 \\ 1 \le j_1 < \dots < j_{s - 1 - k} \le s - 1 \\ \{i_1, \dots, i_k\} \cup \{j_1, \dots, j_{s - 1 - k}\} = \{1, \dots, s - 1\}}}a^{j_1}_{(-n_{j_1} - 1)}\dots a^{j_{s - 1 - k}}_{(-n_{j_{s - 1 - k}} - 1)}a^s_{(l - k - \sum_{r = 1}^k n_{i_r} + \sum_{r = 1}^{s - 1 - k}n_{j_r})}a^{i_k}_{(n_{i_k})}\dots a^{i_1}_{(n_{i_1})}.
  \end{align*}
\end{lemma}

\begin{proof}
  This follows from \Cref{lmm:12} and induction on $s$.
\end{proof}

We now extend the $n$-products.
Let $a(w), b(w) \in \mathcal{F}(V)$ be fields.
For $n \in \mathbb{N}$, $\partial^n_wa(w)$ is also a field, and we define
\begin{equation}
  \label{eq:10}
  a(w)_{(-n - 1)}b(w) = \frac{:(\partial^n_wa(w))b(w):}{n!}.
\end{equation}

A \emph{vertex algebra} is the data consisting of four elements $(V, \vac, T, Y)$ satisfying the following properties:
\begin{enumerate}
\item $V$ is a vector space called the \emph{state space};
\item $\vac \in V$ is called the \emph{vacuum vector};
\item $T \in \End(V)$ is called the \emph{translation operator};
\item $Y: V \to \mathcal{F}(V)$ is a linear map called the \emph{state-field correspondence}, which is commonly written as $Y(a, z) = \sum_{n \in \mathbb{Z}}a_{(n)}z^{-n - 1}$ for $a \in V$.
\end{enumerate}
The data must satisfy the following axioms for $a \in V$:
\begin{enumerate}
\item (Vacuum axiom)
  \begin{align*}
    Y(\vac,z) &= \Id_V, \\
    Y(a, z)\vac &\in V[[z]], \\
    Y(a, z)\vac|_{z = 0} &= a, \\
    T\vac &= 0;
  \end{align*}
\item (Translation covariance) $[T, Y(a, z)] = \partial_zY(a, z)$;
\item (Locality) $\{Y(b, z) \mid b \in V\}$ is a local family of fields.
\end{enumerate}

Formal distribution Lie algebras give us a way to construct nontrivial vertex algebras.
But first, we need a preliminary concept.
A \emph{pre-vertex algebra} is a quadruple $(V, \vac, T, \mathcal{F})$, where $V$ is a vector space, $\vac \in V$, $T \in \End(V)$, and $\mathcal{F} = \{a^j(z) = \sum_{n \in \mathbb{Z}}a^j_{(n)}z^{-n - 1}\}_{j \in J}$ is a collection of $\End(V)$-valued fields.
The above data satisfies the following axioms:
\begin{enumerate}
\item (Vacuum axiom) $T\vac = 0$;
\item (Translation covariance) $[T, a^j(z)] = \partial_za^j(z)$ for $j \in J$;
\item (Locality) $a^i(z)$ and $a^j(z)$ are mutually local for $i, j \in J$;
\item (Completeness) $\vspan\{a^{j_1}_{(n_1)}\dots a^{j_s}_{(n_s)}\vac \mid s \in \mathbb{N}, j_i \in J, n_i \in \mathbb{Z}\} = V$.
\end{enumerate}

Let $V$ be a vertex algebra.
A \emph{vertex subalgebra of $V$} is a subspace of $W$ of $V$, which contains $\vac$, and such that $Y(a, z)b \in W((z))$ for $a, b \in W$.
An \emph{ideal of a vertex algebra $V$} is a subspace $I$ of $V$ such that $Y(a, z)b \in I((z))$ and $Y(b, z)a \in I((z))$ for $a \in V$ and $b \in I$.
The \emph{quotient vertex algebra} $A/I$ is defined in the usual way.
For example, the kernel of a vertex algebra homomorphism is an ideal.
A vertex algebra is \emph{simple} or \emph{irreducible} if $0$ is the only proper ideal.

Let $(V, \vac, T, \mathcal{F})$ be a pre-vertex algebra, and we set
\begin{equation*}
  \mathcal{F}_{\max} = \{a(z) \in \mathcal{F}(V) \mid \text{$[T, a(z)] = \partial_za(z)$ and for $j \in J$, $(a(z), a^j(z))$ is a local pair}\}.
\end{equation*}

\begin{theorem}[Extension theorem {\cite[Theorem 1]{callegaro_introduction_2017-1}}]
  \label{thr:18}
  Let $(V, \vac, T, \mathcal{F})$ be a pre-vertex algebra, and let $\mathcal{F}_{\max}$ be defined as above.
  Then:
  \begin{enumerate}
  \item The linear map
    \begin{align*}
      \fs: \mathcal{F}_{\max} &\to V, \\
      \fs(a(z)) &= a(z)\vac|_{z = 0}
    \end{align*}
    is well-defined and bijective, and we denote by $Y: V \to \mathcal{F}(V)$ the inverse map;
  \item $(V, \vac, T, Y)$ is a vertex algebra, with $Y: V \to \mathcal{F}(V)$ given explicitly by
    \begin{equation}
      \label{eq:13}
      Y(a^{j_1}_{(n_1)}a^{j_2}_{(n_2)}\dots a^{j_s}_{(n_s)}\vac) = a^{j_1}(z)_{(n_1)}(a^{j_2}(z)_{(n_2)}\dots(a^{j_s}(z)_{(n_s)}\Id_V)\dots)
    \end{equation}
    for $s \in \mathbb{N}$, $j_1, \dots, j_s \in J$ and $n_1, \dots, n_s \in \mathbb{Z}$.
  \end{enumerate}
\end{theorem}

Let $(\mathfrak{g}, \mathfrak{F}, T_0)$ be a regular formal distribution Lie algebra with $\mathfrak{F} = \{a^j(z)\}_{j \in J}$, and let $\mathfrak{g}_-$ be the annihilation subalgebra.
Since $T_0(\mathfrak{g}_-) \subseteq \mathfrak{g}_-$, we can extend $T_0$ to a derivation (still denoted the same) $T_0: U(\mathfrak{g}) \to U(\mathfrak{g})$ which is a $(U(\mathfrak{g}), U(\mathfrak{g}_-))$-bimodule homomorphism.
We consider the trivial representation $0: \mathfrak{g}_- \to \mathfrak{gl}(\mathbb{C})$, and we define:
\begin{align*}
  V &= \Ind^{\mathfrak{g}}_{\mathfrak{g}_-}(\mathbb{C}) = U(\mathfrak{g}) \otimes_{U(\mathfrak{g}_-)} \mathbb{C}, \\
  \pi &= \Ind^{\mathfrak{g}}_{\mathfrak{g}_-}(0): \mathfrak{g} \to \mathfrak{gl}(V), \\
  \vac &= 1\otimes1 \in V, \\
  T &= T_0\otimes\Id_{\mathbb{C}} \in \End(V), \\
  \mathcal{F} &= \left\{\pi(a^j(z)) = \sum_{n \in \mathbb{Z}}\pi(a^j_{(n)})z^{-n - 1} \mid j \in J\right\}.
\end{align*}

\begin{theorem}[{\cite[Theorem 3]{callegaro_introduction_2017-1} or \cite[\S1.7]{de_sole_finite_2006}}]
  \label{thr:19}
  With the notation above, $\mathcal{F}$ consists of fields, and $(V, \vac, T, \mathcal{F})$ is a pre-vertex algebra.
\end{theorem}

By \Cref{thr:19} and the Extension theorem, $V$ is a vertex algebra, denoted by $V(\mathfrak{g}, \mathfrak{F}, T_0)$, and by the PBW theorem, it is explicitly given by
\begin{equation}
  \label{eq:16}
  V = \vspan\{a^{j_1}_{(-n_1 - 1)}\dots a^{j_s}_{(-n_s - 1)}\vac \mid s, n_1, \dots, n_s \in \mathbb{N}, j_1, \dots, j_s \in J\}.
\end{equation}

Usually, we need to quotient the vertex algebras obtained this way.
Let $(\mathfrak{g}, \mathfrak{F}, T_0)$ be a regular formal distribution Lie algebra, and let $\lambda: \mathfrak{h} \to \mathbb{C}$ be a linear functional, where $\mathfrak{h}$ is a subalgebra of $\mathfrak{g}_+$ with $\mathfrak{h} \subseteq \ker(T_0)$.
We denote by $I^{\lambda}$ the $\mathfrak{g}$-submodule of $V(\mathfrak{g}, \mathfrak{F}, T_0)$ generated by the vectors $(a - \lambda(a))\vac$ for $a \in \mathfrak{h}$.
The submodule $I^{\lambda}$ is $T$-invariant and is a left ideal.
Thus, $I^{\lambda}$ is an ideal of $V(\mathfrak{g}, \mathfrak{F}, T_0)$.
Taking the quotient, we get a vertex algebra, denoted by
\begin{equation*}
  V^{\lambda}(\mathfrak{g}, \mathfrak{F}, T_0) = V(\mathfrak{g}, \mathfrak{F}, T_0)/I^{\lambda}.
\end{equation*}

\begin{example}[\emph{Universal Virasoro vertex algebra of central charge $c$}]
  \label{exa:5}
  We pick $c \in \mathbb{C}$.
  We take $(\Vir, \{L(z), C\}, \ad(L_{-1}))$ as the regular formal distribution Lie algebra as constructed in \Cref{exa:1} and $\lambda: \mathbb{C}C \to \mathbb{C}, \lambda(C) = c$ as the linear functional.
  The resulting vertex algebra is the universal Virasoro vertex algebra of central charge $c$, denoted by $\Vir^c$.

  By the PBW theorem, for $c \in \mathbb{C}$, a basis of $\Vir^c$ is given by
  \begin{equation*}
    \{L_{\lambda}\vac \mid \text{$\lambda \vdash$ and $\lambda_{\len(\lambda)} \ge 2$}\}.
  \end{equation*}
\end{example}

\begin{example}[\emph{Universal affine vertex algebra of level $k$}]
  \label{exa:6}
  We pick $k \in \mathbb{C}$.
  We take $(\hat{\mathfrak{g}}, \{a(z) \mid a \in \mathfrak{g}\} \cup \{K\}, -\partial_t)$ as the regular formal distribution Lie algebra as constructed in \Cref{exa:2} and $\lambda: \mathbb{C}K \to \mathbb{C}, \lambda(K) = k$ as the linear functional.
  The resulting vertex algebra is the universal affine vertex algebra of level $k$, denoted by $V^k(\mathfrak{g})$.
\end{example}

Let $V$ be a vertex algebra.
A \emph{conformal vector of central charge $c \in \mathbb{C}$ of $V$} is a vector $\omega \in V$ such that $Y(\omega, z) = \sum_{n \in \mathbb{Z}}L_nz^{-n - 2}$ satisfies:
\begin{enumerate}
\item $Y(\omega, z)$ is a Virasoro formal distribution of central charge $C = c\Id_V$, i.e., it satisfies the Virasoro relations \eqref{eq:53} with $C = c\Id_V$;
\item $L_{-1} = T$;
\item $L_0$ is diagonalizable.
\end{enumerate}

The \emph{grading of $V$} is the eigenspace decomposition of $L_0$
\begin{equation*}
  V = \bigoplus_{\Delta \in \mathbb{C}}V_{\Delta},
\end{equation*}
where
\begin{equation*}
  V_{\Delta} = \ker(L_0 - \Delta\Id_V) \quad \text{for $\Delta \in \mathbb{C}$}.
\end{equation*}
If $a$ is an eigenvector of $H$, it is called \emph{homogeneous}, its eigenvalue is called the \emph{conformal weight of $a$}, and it is denoted by $\Delta_a$.

\begin{lemma}
  \label{lmm:12}
  In a conformal vertex algebra $V$ such that $V_0 = \mathbb{C}\vac$, there is a unique maximal proper ideal $I_{\max}$ and a unique simple quotient $V/I_{\max}$.
\end{lemma}

\begin{proof}
  We simply let $I_{\max}$ be the sum of all proper ideals $I$.
\end{proof}

The conformal vertex algebra $\Vir^c$ satisfies $\Vir^c_0 = \mathbb{C}\vac$.
We denote by $\Vir_c$ the unique simple quotient, and we call it the \emph{simple Virasoro vertex algebra of central charge $c$}.
Let $p, q \ge 2$ be relatively prime integers, and we set
\begin{equation*}
  c_{p, q} = 1 - \frac{6(p - q)^2}{pq}.
\end{equation*}

Let $V$ be a $\Vir$-module.
A vector $u$ in $V$ is called \emph{singular} if it is nonzero and
\begin{equation*}
  L_nu = 0 \quad \text{for $n \in \mathbb{Z}_+$}.
\end{equation*}

\begin{theorem}[{\cite{gorelik_simplicity_2007}}]
  \label{thr:23}
  The following are equivalent:
  \begin{enumerate}
  \item $\Vir^c$ is not simple, i.e., $\Vir^c \neq \Vir_c$;
  \item $c$ is of the form $c_{p, q}$ for some $p, q \ge 2$ relatively prime integers.
  \end{enumerate}
  Moreover, the maximal proper ideal of $\Vir^{c_{p, q}}$ is generated by a singular vector of conformal weight $(p - 1)(q - 1)$, denoted by $a_{p, q}$.
  In the expression
  \begin{equation*}
    a_{p, q} = \sum_{\substack{\lambda \vdash (p - 1)(q - 1) \\ \lambda_{\len(\lambda)} \ge 2}}c_{\lambda}L_{\lambda}\vac,
  \end{equation*}
  where $c_{\lambda} \in \mathbb{Q}$, the coefficient of $L_{-2}^{(p - 1)(q - 1)/2}$ is nonzero.
\end{theorem}

Let $V$ be a vertex algebra.
A \emph{module over $V$}, $V$-module or \emph{representation of $V$} is a vector space $M$ together with a linear map
\begin{align*}
  Y^M(\bullet, z): V &\to \mathcal{F}(M), \\
  a &\mapsto Y^M(a, z) = \sum_{n \in \mathbb{Z}}a^M_{(n)}z^{-n - 1}
\end{align*}
satisfying:
\begin{enumerate}
\item $Y(\vac, z) = \Id_M$;
\item (Borcherds identity) For $a, b \in V$, $u \in M$ and $m, n, k \in \mathbb{Z}$,
  \begin{equation*}
    \sum_{j \in \mathbb{N}}(-1)^j\binom{n}{j}\left(a^M_{(m + n - j)}(b^M_{(k + j)}u) - (-1)^nb^M_{(n + k - j)}(a^M_{(m + j)}u)\right) = \sum_{j \in \mathbb{N}}\binom{m}{j}(a_{(n + j)}b)^M_{(m + k - j)}u.
  \end{equation*}
\end{enumerate}

The vertex algebra $V$ is a $V$-module, and it is called the \emph{adjoint representation of $V$}.
A \emph{submodule of $M$} is a subspace $N$ of $M$ such that $Y^M(a, z)u \in N((z))$ for $a \in V$ and $u \in N$, i.e., $a^M_{(n)}u \in N$ for $n \in \mathbb{Z}$.
The \emph{quotient module} $M/N$ is defined in the usual way.
A module whose only proper submodule is $0$ is called \emph{simple} or \emph{irreducible}.

\begin{proposition}
  \label{prp:4}
  Let $V$ be a vertex algebra, and let $Y^M: V \to \mathcal{F}(M)$ be a $V$-module.
  For $s, n_1, \dots, n_s \in \mathbb{N}$ and $a^1, \dots, a^s \in V$,
  \begin{equation*}
    Y^M(a^1_{(-n_1 - 1)}\dots a^s_{(-n_s - 1)}\vac, z) = \frac{:\partial^{n_1}_zY^M(a^1, z)\dots\partial^{n_s}_zY^M(a^s, z):}{n_1!\dots n_s!}.    
  \end{equation*}
\end{proposition}

\begin{proof}
  This is a consequence of the $n$-product identity for modules over vertex algebras (\cite[(5.2.16)]{lepowsky_introduction_2004}) and definition \eqref{eq:10}.
\end{proof}

Let $(\mathfrak{g}, \mathfrak{F}, T_0)$ be a regular formal distribution Lie algebra with $\mathfrak{F} = \{a^j(z)\}_{j \in J}$.
A \emph{smooth} $(\mathfrak{g}, \mathfrak{F}, T_0)$-module is a $\mathfrak{g}$-module $M$ such for $j \in J$ and $u \in M$, $a^j(z)u \in M((z))$.
Let $\lambda: \mathfrak{h} \to \mathbb{C}$ be a linear functional, where $\mathfrak{h}$ is a subalgebra of $\mathfrak{g}_+$ with $\mathfrak{h} \subseteq \ker(T_0)$.
We say $\mathfrak{h}$ \emph{acts as $\lambda$} if for $h \in \mathfrak{h}$ and $u \in M$, $hu = \lambda(h)u$.

\begin{theorem}[{\cite[Theorem 2.15]{li_vertex_2004}}]
  \label{thr:25}
  Let $(\mathfrak{g}, \mathfrak{F}, T_0)$ be a regular formal distribution Lie algebra with $\mathfrak{F} = \{a^j(z)\}_{j \in J}$.
  Given a smooth $(\mathfrak{g}, \mathfrak{F}, T_0)$-module $M$, there is a unique module structure $Y^M: V(\mathfrak{g}, \mathfrak{F}, T_0) \to \mathcal{F}(M)$ such that for $j \in J$ and $u \in M$, $Y^M(a^j_{(-1)}\vac, z)u = a^j(z)u$.
  Let $\lambda: \mathfrak{h} \to \mathbb{C}$ be a linear functional, where $\mathfrak{h}$ is a subalgebra of $\mathfrak{g}_+$ with $\mathfrak{h} \subseteq \ker(T_0)$.
  Given a smooth $(\mathfrak{g}, \mathfrak{F}, T_0)$-module $M$, where $h$ acts as $\lambda$, there is a unique module structure $Y^M: V^{\lambda}(\mathfrak{g}, \mathfrak{F}, T_0) \to \mathcal{F}(M)$ such that for $j \in J$ and $u \in M$, $Y^M(a^j_{(-1)}\vac, z)u = a^j(z)u$.
\end{theorem}

\begin{example}
  \label{exa:11}
  Let $M$ be a highest weight representation of $\Vir$ with highest weight $(c, h)$.
  Then $M$ is a smooth $\Vir$-module of central charge $c$.
  We note that $L_0$ is diagonalizable.
  By \Cref{thr:25}, $M$ is an $h + \mathbb{N}$-graded $\Vir^c$-module.
\end{example}

We are interested in the irreducible modules over the simple Virasoro vertex algebras $\Vir_{p, q} = \Vir_{c_{p, q}} = L(c_{p, q}, 0)$, where $p, q \ge 2$ are relatively prime integers.
In this context, the following constants play a crucial role.
For integers $m, n$ such that $0 < m < p$ and $0 < n < q$, we set
\begin{equation*}
  h_{m, n} = \frac{(np - mq)^2 - (p - q)^2}{4pq}.
\end{equation*}

\begin{theorem}[{\cite{wang_rationality_1993}}]
  \label{thr:44}
  We set $c = c_{p, q}$ for some $p, q \ge 2$ relatively prime integers.
  Then the irreducible admissible modules over $\Vir_c$ are $L(c, h_{m, n})$ for integers $m, n$ such that $0 < m < p$ and $0 < n < q$.
  Let $Y^{L(c, h_{m, n})}_{\Vir^c}: \Vir^c \to \mathcal{F}(L(c, h_{m, n}))$ be the state-field correspondence of $L(c, h_{m, n})$ as a module over $\Vir^c$, and let $Y^{L(c, h_{m, n})}_{\Vir_c}: \Vir_c \to \mathcal{F}(L(c, h_{m, n}))$ be the state-field correspondence of $L(c, h_{m, n})$ as a module over $\Vir_c$.
  Then the following diagram commutes
  \begin{equation*}
    \begin{tikzcd}
      \Vir^c \arrow[r, two heads] \arrow[rd, "{Y^{L(c, h_{m, n})}_{\Vir^c}}"'] & {\Vir_c} \arrow[d, "{Y^{L(c, h_{m, n})}_{\Vir_c}}"] \\
      & {\mathcal{F}(L(c, h_{m, n}))}
    \end{tikzcd}
  \end{equation*}
  where the horizontal arrow is the quotient map.
\end{theorem}

We are also interested in the refined character of these irreducible modules.
The ordinary character is fortunately already known.

\begin{theorem}[{\cite{feigin_verma_1984}}]
  \label{thr:5}
  Let $p, q \ge 2$ be relatively prime integers, and let $m, n$ be integers such that $0 < m < p$ and $0 < n < q$.
  Then
  \begin{align*}
    \ch_{L(c_{p, q}, h_{m, n})}(q) &= \frac{1}{(q)_{\infty}}\sum_{k \in \mathbb{Z}}q^{\frac{(2kpq + mq - np)^2 - (p - q)^2}{4pq}} - q^{\frac{(2kpq + mq + np)^2 - (p - q)^2}{4pq}} \\
                                   &= \frac{q^{h_{m, n}}}{(q)_{\infty}}\sum_{k \in \mathbb{Z}}q^{k^2pq + k(mq - np)}-q^{k^2pq + k(mq + np) + mn}. \\
  \end{align*}
\end{theorem}

In this article, we consider:
\begin{align*}
  p &= 2, \\
  q &= 2s + 1 \quad \text{for $s \in \mathbb{Z}_+$}.
\end{align*}
By \Cref{thr:44}, $\Vir_{2, 2s + 1}$ has $s$ irreducible modules $L(c_{2, 2s + 1}, h_{1, 1}), \dots, L(c_{2, 2s + 1}, h_{1, s})$, known collectively as the \emph{boundary minimal models}.

\section{Proofs of the main theorems}
\label{sec:proofs-main-theorems}

In this section, we fix $s \in \mathbb{Z}_+$ and $i \in \{1, 2, \dots, s\}$.

A partition $\lambda = [\lambda_1, \dots, \lambda_m]$ \emph{contains a partition} $\eta = [\eta_1, \dots, \eta_n]$, written as $\eta \subseteq \lambda$, if $m \ge n$ and there is $i \in \mathbb{Z}_+$ such that $1 \le i \le m - n + 1$ and $[\lambda_i, \lambda_{i + 1}, \dots, \lambda_{i + n - 1}] = \eta$.

We define
\begin{equation*}
  p^{s, i}(t, q) = \sum_{\lambda \in P^{s, i}}t^{\len(\lambda)}q^{\Delta(\lambda)} \in \mathbb{C}[[t, q]],
\end{equation*}
where $P^{s, i}$ is the set of partitions that do not contain any partition in $R^{s, i}$ as defined in \Cref{sec:introduction}, i.e.,
\begin{equation*}
  P^{s, i} = \{\lambda \vdash \mid \text{for $\eta \in R^{s, i}$, $\lambda \nsupseteq \eta$}\}.
\end{equation*}

\begin{lemma}
  \label{lmm:5}
  We have
  \begin{equation*}
    p^{s, i}(t, q) = J_{s, i}(0, t, q) = \sum_{k = (k_1, \dots, k_{s - 1}) \in \mathbb{N}^{s - 1}}t^{kB^{(s)}_{s - 1}}\frac{q^{\frac{1}{2}kG^{(s)}k^T + kB^{(s)}_{s - i}}}{(q)_{k_1}\dots(q)_{k_{s - 1}}}.
  \end{equation*}
\end{lemma}

\begin{proof}
  Following the notation of \cite[\S7.2]{andrews_theory_1998}, we write:
  \begin{align*}
    p^{s, i}(t, q) &= \sum_{m = 0}^{\infty}\sum_{n = 0}^{\infty}b_{s, i}(m, n)t^mq^n, \\
    J_{s, i}(0, t, q) &= \sum_{m = 0}^{\infty}\sum_{n = 0}^{\infty}c_{s, i}(m, n)t^mq^n.
  \end{align*}
  By \cite[\S7.3]{andrews_theory_1998}, we have $b_{s, i}(m, n) = c_{s, i}(m, n)$ for $m, n \in \mathbb{N}$.
  This means $p^{s, i}(t, q) = J_{s, i}(0, t, q)$.

  By the proof of \cite[Theorem 7.8]{andrews_theory_1998}, we have
  \begin{equation*}
    J_{s, i}(0, t, q) = \sum_{k = (k_1, \dots, k_{s - 1}) \in \mathbb{N}^{s - 1}}\frac{t^{N_1 + \dots + N_{s - 1}}q^{N_1^2 + \dots + N_{s - 1}^2 + N_i + \dots + N_{s - 1}}}{(q)_{k_1}\dots(q)_{k_{s - 1}}},
  \end{equation*}
  where $N_j = k_j + \dots + k_{s - 1}$ for $j = 0, 1, \dots, s - 1$.
  Since
  \begin{align*}
    N_1^2 + \dots + N_{s - 1}^2 &= \frac{1}{2}kG^{(s)}k^T, \\
    N_j + \dots + N_{s - 1} &= kB^{(s)}_{s - j} \quad \text{for $j = 0, 1, \dots, s - 1$},
  \end{align*}
  we have
  \begin{equation*}
    \sum_{k = (k_1, \dots, k_{s - 1}) \in \mathbb{N}^{s - 1}}\frac{t^{N_1 + \dots + N_{s - 1}}q^{N_1^2 + \dots + N_{s - 1}^2 + N_i + \dots + N_{s - 1}}}{(q)_{k_1}\dots(q)_{k_{s - 1}}} = \sum_{k = (k_1, \dots, k_{s - 1}) \in \mathbb{N}^{s - 1}}t^{kB^{(s)}_{s - 1}}\frac{q^{\frac{1}{2}kG^{(s)}k^T + kB^{(s)}_{s - i}}}{(q)_{k_1}\dots(q)_{k_{s - 1}}}. \qedhere
  \end{equation*}
\end{proof}

\begin{lemma}
  \label{lmm:4}
  We have
  \begin{equation*}
    \ch_{L(c_{2, 2s + 1}, h_{1, i})}(q) = q^{h_{1, i}}p^{s, i}(1, q) = q^{h_{1, i}}\prod_{\substack{n = 1 \\ n \not\equiv 0, \pm i \mod 2k + 1}}(1 - q^n)^{-1}.
  \end{equation*}
\end{lemma}

\begin{proof}
  By \Cref{lmm:5}, \cite[Lemma 7.3]{andrews_theory_1998} and \cite[Corollary 2.9]{andrews_theory_1998}, we have
  \begin{align*}
    q^{h_{1, i}}p^{s, i}(1, q) &= q^{h_{1, i}}J_{s, i}(0, 1, q) \\
                               &= q^{h_{1, i}}\prod_{\substack{n = 1 \\ n \not\equiv 0, \pm i \mod 2k + 1}}(1 - q^n)^{-1} \\
                               &= \frac{q^{h_{1, i}}}{(q)_{\infty}}\sum_{k \in \mathbb{N}}(-1)^kq^{(2s + 1)k(k + 1)/2 - ki}(1 - q^{(2k + 1)i}) \\
                               &= \frac{q^{h_{1, i}}}{(q)_{\infty}}\sum_{k \in \mathbb{Z}}(-1)^kq^{(2s + 1)k(k + 1)/2 - ki}.
  \end{align*}
  The disjoint union $\mathbb{Z} = \{2k \mid k \in \mathbb{Z}\} \cup \{-2k - 1 \mid k \in \mathbb{Z}\}$ and \Cref{thr:5} imply that
  \begin{align*}
    \frac{q^{h_{1, i}}}{(q)_{\infty}}\sum_{k \in \mathbb{Z}}(-1)^kq^{(2s + 1)k(k + 1)/2 - ki} &= \frac{q^{h_{1, i}}}{(q)_{\infty}}\Bigg(\sum_{k \in \mathbb{Z}}(-1)^{2k}q^{(2s + 1)2k(2k + 1)/2 - 2ki} \\
                                                                                              &\quad + \sum_{k \in \mathbb{Z}}(-1)^{-2k - 1}q^{(2s + 1)(-2k - 1)(-2k - 1 + 1)/2 - (-2k - 1)i}\Bigg) \\
                                                                                              &= \frac{q^{h_{1, i}}}{(q)_{\infty}}\left(\sum_{k \in \mathbb{Z}}q^{2k^2(2s + 1) + k(2s + 1 - 2i)} - \sum_{k \in \mathbb{Z}}q^{2k^2(2s + 1) + k(2s + 2i + 1) + i}\right) \\
                                                                                              &= \ch_{L(c_{2, 2s + 1}, h_{1, i})}(q). \qedhere
  \end{align*}
\end{proof}

We order the PBW basis of $U(\Vir^-) = \vspan\{L_{\lambda} \mid \lambda \vdash\}$ by degree reverse lexicographic order with $L_{-1} > L_{-2} > \dots$.
Formally, for any partitions $\lambda$ and $\eta$, we define
\begin{equation*}
  L_{\lambda} \le L_{\eta}\text{ if and only if }p_{\lambda} \le p_{\eta}.
\end{equation*}
For $x \in U(\Vir^-)$ with $x \neq 0$, we may write
\begin{equation*}
  x = c_1L_{\lambda^1} + c_2L_{\lambda^2} + \dots + c_rL_{\lambda^r},
\end{equation*}
where for $1 \le i \le r$, $0 \neq c_i \in \mathbb{C}$ and $L_{\lambda^1} > L_{\lambda^2} > \dots > L_{\lambda^r}$.
We define the \emph{leading power of $x$} as $\lp(x) = L_{\lambda^1}$.
We set $\lp(0) = 0$.
Next, for a highest weight $(c, h)$, we extend the definition of $\lp$ from $U(\Vir^-)$ to $M(c, h)$ by considering the isomorphism of vector spaces $U(\Vir^-) \xrightarrow{\sim} M(c, h), L_{\lambda} \mapsto L_{\lambda}|c, h\rangle$, where $\lambda$ is a partition.

\begin{remark}
  \label{rmk:6}
  The definition of the order in the PBW basis of $U(\Vir^-)$ was made so that for a highest weight $(c, h)$, a partition $\lambda$ and $u \in M(c, h)$, if $\lp(u) = L_{\lambda}|c, h\rangle$, then $\lp(\gamma^{\len(\lambda)}(u)) = p_{\lambda}$.
\end{remark}

\begin{lemma}
  \label{lmm:3}
  For $\lambda \in R^{s, i}$, there exists $u \in J(c_{2, 2s + 1}, h_{1, i})$ homogeneous such that $\lp(u) = L_{\lambda}|c_{2, 2s + 1}, h_{1, i}\rangle$.
\end{lemma}

\begin{proof}
  By \Cref{thr:23}, the maximal proper ideal of $\Vir^{c_{2, 2s + 1}}$ is generated by a singular vector of conformal weight $2s$, denoted by $a_{2, 2s + 1}$, which has the form
  \begin{equation}
    \label{eq:8}
    a_{2, 2s + 1} = L_{-2}^s\vac + \sum_{\substack{\mu \vdash 2s \\ \mu_{\len(\mu)} \ge 2 \\ \len(\mu) < s}}c_{\mu}L_{\mu}\vac,
  \end{equation}
  where $c_{\mu} \in \mathbb{Q}$.
  We have two cases:
  \begin{enumerate}
  \item $\lambda = [\underbrace{a + 1, \dots, a + 1}_{s - d}, \underbrace{a, \dots, a}_d]$ for some $a \in \mathbb{Z}_+$ and $d \in \{1, \dots, s\}$.
    We set
    \begin{equation*}
      u = (a_{2, 2s + 1})_{(s - sa + d - 1)}|c_{2, 2s + 1}, h_{1, i}\rangle
    \end{equation*}
    and claim
    \begin{equation}
      \label{eq:7}
      \lp(u) = L_{\lambda}|c_{2, 2s + 1}, h_{1, i}\rangle.
    \end{equation}
    To prove this, we first prove that
    \begin{equation}
      \label{eq:6}
      (L_{-2}^s\vac)_{(s - sa + d - 1)}|c_{2, 2s + 1}, h_{1, i}\rangle = \binom{s}{d}L_{\lambda}|c_{2, 2s + 1}, h_{1, i}\rangle + \sum_{\substack{\mu \vdash \Delta(\lambda) \\ \len(\mu) \le \len(\lambda) \\ \mu \neq \lambda}}c_{\mu}L_{\mu}|c_{2, 2s + 1}, h_{1, i}\rangle,
    \end{equation}
    where $c_{\mu} \in \mathbb{Q}$.
    Applying \Cref{prp:4} and \Cref{lmm:1} with
    \begin{align*}
      a^1(z) = \dots = a^s(z) &= L(z) = \sum_{n \in \mathbb{Z}}L_{(n)}z^{-n - 1} = \sum_{n \in \mathbb{Z}}L_nz^{-n - 2}, \\
      b &= |c_{2, 2s + 1}, h_{1, i}\rangle, \\
      l &= s - sa + d - 1,
    \end{align*}
    we obtain
    \begin{equation}
      \label{eq:5}
      (L_{-2}^s\vac)_{(l)}|c_{2, 2s + 1}, h_{1, i}\rangle = \sum_{n_1, \dots, n_{s - 1} \in \mathbb{N}}\sum_{k = 0}^{s - 1}R^{l, k}_{n_1, \dots, n_{s - 1}}(L(z), \dots, L(z))|c_{2, 2s + 1}, h_{1, i}\rangle,
    \end{equation}
    where $R^{l, k}_{n_1, \dots, n_{s - 1}}(L(z), \dots, L(z))$ is the sum of $\binom{s - 1}{k}$ terms given by
    \begin{align*}
      &R^{l, k}_{n_1, \dots, n_{s - 1}}(L(z), \dots, L(z)) = \\
      &\sum_{\substack{1 \le i_1 < \dots < i_k \le s - 1 \\ 1 \le j_1 < \dots < j_{s - 1 - k} \le s - 1 \\ \{i_1, \dots, i_k\} \cup \{j_1, \dots, j_{s - 1 - k}\} = \{1, \dots, s - 1\}}}L_{(-n_{j_1} - 1)}\dots L_{(-n_{j_{s - 1 - k}} - 1)}L_{(l - k - \sum_{r = 1}^k n_{i_r} + \sum_{r = 1}^{s - 1 - k}n_{j_r})}L_{(n_{i_k})}\dots L_{(n_{i_1})},
    \end{align*}
    where
    \begin{align*}
      &L_{(-n_{j_1} - 1)}\dots L_{(-n_{j_{s - 1 - k}} - 1)}L_{(l - k - \sum_{r = 1}^k n_{i_r} + \sum_{r = 1}^{s - 1 - k}n_{j_r})}L_{(n_{i_k})}\dots L_{(n_{i_1})} = \\
      &L_{-n_{j_1} - 2}\dots L_{-n_{j_{s - 1 - k}} - 2}L_{s - sa + d - 2 - k - \sum_{r = 1}^k n_{i_r} + \sum_{r = 1}^{s - 1 - k}n_{j_r}}L_{n_{i_k} - 1}\dots L_{n_{i_1} - 1}
    \end{align*}
    We see that each term $L_{\mu}$ appearing in $R^{l, k}_{n_1, \dots, n_{s - 1}}(L(z), \dots, L(z))$, where $\mu$ is a combination (not necessarily a partition), satisfies $\Delta(\mu) = sa + s - d = \Delta(\lambda)$ and $\len(\mu) \le \len(\lambda)$.
    
    We recall that $L_{\lambda} - L_{\lambda\sigma} \in U(\Vir^{-})^{\len(\lambda) - 1}$ for a combination $\lambda$ and a permutation $\sigma \in S_m$ (see \cite[\S2]{dixmier_enveloping_1996} for details).    
    Therefore, for a combination $\mu$, we can expand $L_{\mu}|c_{2, 2s + 1}, h_{1, i}\rangle$ in the following way
    \begin{equation*}
      L_{\mu}|c_{2, 2s + 1}, h_{1, i}\rangle = L_{\prt(\mu)}|c_{2, 2s + 1}, h_{1, i}\rangle + \sum_{\substack{\mu \vdash \Delta(\lambda) \\ \len(\mu) < \len(\lambda)}}c_{\mu}L_{\mu}|c_{2, 2s + 1}, h_{1, i}\rangle,
    \end{equation*}
    where $c_{\mu} \in \mathbb{Q}$.
    We need to compute the coefficient of $L_{\lambda}|c_{2, 2s + 1}, h_{1, i}\rangle$ in $u$ when expressed as a linear combination of the elements of the usual PBW basis.
    To do this, we need to see how much each sum $R^{l, k}_{n_1, \dots, n_{s - 1}}(L(z), \dots, L(z))|c_{2, 2s + 1}, h_{1, i}\rangle$ contributes to the coefficient of $L_{\lambda}|c_{2, 2s + 1}, h_{1, i}\rangle$ in $u$.
    We have two subcases:
    \begin{description}[leftmargin = !]
    \item[Subcase $a = 1$] In the sum \eqref{eq:5}, if $k > d$ or $k < d - 1$ or $n_i \neq 0$ for some $i = 1, \dots, s - 1$, then $R^{l, k}_{n_1, \dots, n_{s - 1}}(L(z), \dots, L(z))|c_{2, 2s + 1}, h_{1, i}\rangle$ contributes $0$.
      As for the two remaining sums, the sum $R^{l, d - 1}_{0, \dots, 0}(L(z), \dots, L(z))|c_{2, 2s + 1}, h_{1, i}\rangle$ contributes $\binom{s - 1}{d - 1}$, and the sum $R^{l, d}_{0, \dots, 0}(L(z), \dots, L(z))|c_{2, 2s + 1}, h_{1, i}\rangle$ contributes $\binom{s - 1}{d}$.
      Since $\binom{s - 1}{d - 1} + \binom{s - 1}{d} = \binom{s}{d}$, we obtain \eqref{eq:6}.
    \item[Subcase $a > 1$] In the sum \eqref{eq:5}, if $k > 0$, then $R^{l, k}_{n_1, \dots, n_{s - 1}}(L(z), \dots, L(z))|c_{2, 2s + 1}, h_{1, i}\rangle$ contributes $0$.
      We have
      \begin{equation*}
        R^{l, 0}_{n_1, \dots, n_{s - 1}}(L(z), \dots, L(z)) = L_{-n_1 - 2}\dots L_{-n_{s - 1} - 2}L_{s - sa + d - 2 + \sum_{r = 1}^{s - 1}n_r}.
      \end{equation*}
      Therefore, the sum $R^{l, 0}_{n_1, \dots, n_{s - 1}}(L(z), \dots, L(z))|c_{2, 2s + 1}, h_{1, i}\rangle$ contributes $\binom{s - 1}{d - 1}$ when exactly $d - 1$ of the $n_i$s are equal to $a - 2$ and $s - d$ of the $n_i$s are equal to $a - 1$, contributes $\binom{s - 1}{d}$ when exactly $d$ of the $n_i$s are equal to $a - 2$ and $s - d - 1$ of the $n_i$s are equal to $a - 1$, and contributes $0$ otherwise.
      Since $\binom{s - 1}{d - 1} + \binom{s - 1}{d} = \binom{s}{d}$, we obtain \eqref{eq:6}.
    \end{description}
  \item $\lambda = \underbrace{[1, 1, \dots, 1]}_i$.
    This follows from \cite{benoit_degenerate_1988}.
  \end{enumerate}
  We note that if $\mu$ is a partition of $\Delta(\lambda)$ such that  $\len(\mu) \le \len(\lambda)$ and $\mu \neq \lambda$, then $L_{\lambda} > L_{\mu}$.
  Thus, \eqref{eq:6} implies $\lp((L_{-2}^s\vac)_{(s - sa + d - 1)}|c_{2, 2s + 1}, h_{1, i}\rangle) = L_{\lambda}|c_{2, 2s + 1}, h_{1, i}\rangle$.
  From \eqref{eq:8} and \Cref{lmm:1}, we see that $\lp(u) = \lp((L_{-2}^s\vac)_{(s - sa + d - 1)}|c_{2, 2s + 1}, h_{1, i}\rangle) = L_{\lambda}|c_{2, 2s + 1}, h_{1, i}\rangle$.
  Finally, by \Cref{thr:44}, $u \in J(c_{2, 2s + 1}, h_{1, i})$, and it is clear that $u$ is homogeneous.
\end{proof}

\begin{remark}
  \label{rmk:9}
  For any partitions $\lambda$ and $\eta$, if $\lambda \supseteq \eta$, then $p_{\eta} \mid p_{\lambda}$.
  The converse is not true.
  For example, $p_{[4, 2]} \mid p_{[4, 3, 2]}$, but $[4, 3, 2] \nsupseteq [4, 2]$.
  However, if $\eta = [\eta_1, \dots, \eta_m]$ and $\eta_1 - \eta_m \le 1$, then $\lambda \supseteq \eta$ if and only if $p_{\eta} \mid p_{\lambda}$.
\end{remark}

\begin{lemma}
  \label{lmm:11}
  There is an alternative description for $P$, namely
  \begin{equation*}
    P^{s, i} = \{\lambda \vdash \mid \text{for $\eta \in R^{s, i}$, $p_{\eta} \nmid p_{\lambda}$}\}.
  \end{equation*}
\end{lemma}

\begin{proof}
  This is a consequence of \Cref{rmk:9}.
\end{proof}

\begin{proof}[Proof of \Cref{thr:2}]
  This follows from Gröbner basis theory, \Cref{prp:8}, \Cref{lmm:4}, \Cref{rmk:6}, \Cref{lmm:3} and \Cref{lmm:11}, see \cite{salazar_pbw_2024} for details.
\end{proof}

\begin{proof}[Proof of \Cref{thr:1}]
  This is a corollary of \Cref{thr:2}, see \cite{salazar_pbw_2024} for details.
\end{proof}

\section{Graded vertex Poisson algebras and their modules}
\label{sec:grad-vert-poiss}

In this section, all algebras and vector spaces are over $\mathbb{C}$.
Let $A$ be a commutative associative algebra.
A \emph{Hamiltonian operator of $A$} is a diagonalizable operator $H \in \End(A)$ such that
\begin{equation*}
  H(ab) = H(a)b + aH(b) \quad \text{for $a, b \in A$}.
\end{equation*}
Thus, a Hamiltonian operator of $A$ is just a derivation of $A$.
An algebra with a Hamiltonian is called \emph{graded}.
The \emph{grading of $A$} is the eigenspace decomposition of $H$
\begin{equation*}
  A = \bigoplus_{\Delta \in \mathbb{C}}A_{\Delta},
\end{equation*}
where
\begin{equation*}
  A_{\Delta} = \ker(H - \Delta\Id_V) \quad \text{for $\Delta \in \mathbb{C}$}.
\end{equation*}
If $a$ is an eigenvector of $H$, it is called \emph{homogeneous}, its eigenvalue is called the \emph{conformal weight of $a$}, and it is denoted by $\Delta_a$.
If $A$ has a unit $1$, it is clear that $H(1) = 0$ and thus, $\Delta_1 = 0$.

Let $A$ be a differential commutative associative algebra with derivation $\partial$.
A \emph{Hamiltonian operator of $A$} is a Hamiltonian operator of $A$ as an algebra such that
\begin{equation*}
  [H, \partial] = \partial.
\end{equation*}

Let $A$ be a Poisson algebra.
A \emph{Hamiltonian operator of $A$} is a Hamiltonian operator of $A$ as a commutative associative algebra such that
\begin{equation*}
  H(\{a, b\}) = \{a, H(b)\} + \{H(a), b\} - \{a, b\} \quad \text{for $a, b \in A$}.
\end{equation*}

Let $(V, T, Y_-)$ be a vertex Lie algebra.
A \emph{Hamiltonian operator of $V$} is a diagonalizable operator $H \in \End(V)$ such that:
\begin{enumerate}
\item $[H, Y_-(a, z)] = z\partial_zY_-(a, z) + Y_-(Ha, z)$ for $a \in V$;
\item $[H, T] = T$.
\end{enumerate}

Let $(V, T, Y_-)$ be a vertex Poisson algebra.
A \emph{Hamiltonian operator of $V$} is simultaneously a Hamiltonian operator of $(V, T)$ as a differential commutative associative algebra and a Hamiltonian operator of $(V, T, Y_-)$ as a vertex Lie algebra.

We only consider $\mathbb{N}$-graded algebras, i.e., algebras $A$ such that $A_n = 0$ unless $n \in \mathbb{N}$.
For a $\mathbb{N}$-graded algebra $A$ such that $\dim(A_n) < \infty$ for $n \in \mathbb{N}$, we define the \emph{character of $A$} by
\begin{equation*}
  \ch_A(q) = \sum_{n \in \mathbb{N}}\dim(A_n)q^n \in \mathbb{C}[[q]].
\end{equation*}

Let $A$ be a graded commutative associative algebra with and Hamiltonian operator $H$, and let $M$ be a $A$-module.
If $A$ has a unit $1$, we further assume that $1u = u$ for $u \in M$. 
A \emph{Hamiltonian operator of $M$} is a diagonalizable operator $H^M \in \End(M)$ such that
\begin{equation*}
  H^M(au) = H(a)u + aH^M(u) \quad \text{for $a \in A$ and $u \in M$}. 
\end{equation*}

Let $(V, T, Y_-)$ be a vertex Lie algebra, and let $M$ be a $V$-module.
A \emph{Hamiltonian operator of $M$} is a diagonalizable operator $H^M \in \End(M)$ such that
\begin{equation*}
  [H^M, Y^M_-(a, z)] = z\partial_zY^M_-(a, z) + Y^M_-(Ha, z) \quad \text{for $a \in V$}.
\end{equation*}

Let $(V, T, Y_-)$ be a vertex Poisson algebra, and let $M$ be a $V$-module.
A \emph{Hamiltonian operator of $M$} is simultaneously a Hamiltonian operator of $V$ as a commutative associative algebra with unit $1$ and a Hamiltonian operator of $M$ as a module over the vertex Lie algebra $V$.

Let $c$
Let $c = c_{p, q}\in \mathbb{C}$.
We have a natural quotient map $\pi^c: \Vir^c \twoheadrightarrow \Vir_c$.

From \Cref{thr:23},
First, we observe that for the general Verma module $M(c, h)$, we have
\begin{equation*}
  F_1M(c, h) = \vspan\{L_{-n_1 - 2}\dots L_{-n_s - 2} \mid \text{$s, n_1, \dots, n_s \in \mathbb{N}$ and for some $j = 1, \dots, s$, $n_j > 0$}\}.
\end{equation*}
Therefo

\begin{proof}[Proof of \Cref{thr:3}]
  We have
  \begin{equation*}
    R_{L(c_{2, 2s + 1}, h_{1, i})} = \sigma_0\left(\frac{M(c_{2, 2s + 1}, h_{1, i})}{J(c_{2, 2s + 1}, h_{1, i})}\right) \cong \frac{\sigma_0(M(c_{2, 2s + 1}, h_{1, i}))}{\sigma_0(J(c_{2, 2s + 1}, h_{1, i}))} \cong \frac{\bigoplus_{k \in \mathbb{N}}\mathbb{C}[L_{-2}]L_{-1}^k}{\sigma_0(J(c_{2, 2s + 1}, h_{1, i}))}.
  \end{equation*}
  First, we prove that for a partition $\eta$ with $\eta = \emptyset$ or $2 \ge \eta_1$,
  \begin{equation*}
    p_{\eta} + \sigma_0(J(c_{2, 2s + 1}, h_{1, i})) \in \vspan\{p_{\lambda} + \sigma_0(J(c_{2, 2s + 1}, h_{1, i})) \mid \text{$\lambda = \emptyset$ or ($\lambda \in P^{s, i}$ and $2 \ge \lambda_1$)}\} = W.
  \end{equation*}
  We assume, for the sake of contradiction, that there is a power $p_{\eta}$ with $\eta = \emptyset$ or $2 \ge \eta_1$ not satisfying $p_{\eta} + \sigma_0(J(c_{2, 2s + 1}, h_{1, i})) \in W$.

  Let $\eta_0$ be the smallest of such powers in the degree reverse lexicographic order with $L_{-1} > L_{-2} > \dots$.
  We must have $\eta_0 \neq \emptyset$ and $\eta_0 \notin P^{s, i}$, otherwise $p_{\eta_0} + \sigma_0(J(c_{2, 2s + 1}, h_{1, i})) \in W$.
  By \Cref{lmm:11}, there is $\mu \in R^{s, i}$ such that $p_{\mu} \mid p_{\eta_0}$.
  From \Cref{lmm:3}, \eqref{eq:11} and the fact that $\lp$ is multiplicative, we obtain $u \in J(c_{2, 2s + 1}, h_{1, i})$ such that $\lp(u) = L_{\eta_0}|c_{2, 2s + 1}, h_{1, i}\rangle$.

  From the equation
  \begin{equation*}
    u = L_{\eta_0}|c_{2, 2s + 1}, h_{1, i}\rangle + \sum_{\substack{\mu \vdash \Delta(\eta_0) \\ p_{\mu} < p_{\eta_0}}}c_{\mu}L_{\mu}|c_{2, 2s + 1}, h_{1, i}\rangle,
  \end{equation*}
  where $c_{\mu} \in \mathbb{C}$, we obtain
  \begin{equation*}
    p_{\eta_0} + \sigma_0(J(c_{2, 2s + 1}, h_{1, i}))= -\sum_{\substack{\mu \vdash \Delta(\eta_0) \\ p_{\mu} < p_{\eta_0} \\ 2 \ge \mu_1} }c_{\mu}(p_{\mu} + \sigma_0(J(c_{2, 2s + 1}, h_{1, i}))).
  \end{equation*}
  The last equation implies $p_{\eta_0} + \sigma_0(J(c_{2, 2s + 1}, h_{1, i})) \in W$ because $p_{\mu} + \sigma_0(J(c_{2, 2s + 1}, h_{1, i})) \in W$ if $p_{\mu} < p_{\eta_0}$ by the minimality of $\eta_0$, and this is a contradiction.
  We have proved that
  \begin{equation}
    \label{eq:3}
    \frac{\bigoplus_{k \in \mathbb{N}}\mathbb{C}[L_{-2}]L_{-1}^k}{\sigma_0(J(c_{2, 2s + 1}, h_{1, i}))} = \vspan\{p_{\lambda} + \sigma_0(J(c_{2, 2s + 1}, h_{1, i})) \mid \text{$\lambda = \emptyset$ or ($\lambda \in P^{s, i}$ and $2 \ge \lambda_1$)}\}
  \end{equation}

  By \cite{van_ekeren_chiral_2021} or \cite{bruschek_arc_2013}, we already know $\Vir_{2, 2s + 1}$ is classically free.
  This means $\gr_F(\Vir_{2, 2s + 1}) \cong JR_{\Vir_{2, 2s + 1}} \cong J(\mathbb{C}[L_{-2}]/(L_{-2}^s)) \cong \mathbb{C}[L_{-2}, L_{-3}, \dots]/(L_{-2}^s)_{\partial}$ and
  \begin{equation}
    \label{eq:4}
    \mathbb{C}[L_{-2}, L_{-3}, \dots]/(L_{-2}^s)_{\partial} = \bigoplus_{\lambda \in P^{s, 1}}\mathbb{C}(p_{\lambda} + (L_{-2}^s)_{\partial}).
  \end{equation}

  We have
  \begin{equation*}
    JR_{\Vir_{2, 2s + 1}} \otimes_{R_{\Vir_{2, 2s + 1}}} R_{L(c_{2, 2s + 1}, h_{1, i})} \cong \frac{\mathbb{C}[L_{-2}, L_{-3}, \dots]}{(L_{-2}^s)_{\partial}} \otimes_{\frac{\mathbb{C}[L_{-2}]}{(L_{-2}^s)}}\frac{\bigoplus_{k \in \mathbb{N}}\mathbb{C}[L_{-2}]L_{-1}^k}{\sigma_0(J(c_{2, 2s + 1}, h_{1, i}))}
  \end{equation*}

  Given a partition $\lambda \in P^{s, i}$, we can write uniquely $\lambda = \lambda^1 \cup \lambda^2$, where $\lambda^1 \in P^{s, 1}$ satisfies $\lambda^1 = \emptyset$ or $\lambda^1_{\len(\lambda^1)} \ge 3$ and $\lambda^2 = \emptyset$ or ($\lambda^2 \in P^{s, i}$ and $2 \ge \lambda^2_1$).

  Given $\lambda \in P^{s, i}$, we define
  \begin{equation*}
    t_{\lambda} = (p_{\lambda^1} + (L_{-2}^s)_{\partial})\otimes(p_{\lambda^2} + \sigma_0(J(c_{2, 2s + 1}, h_{1, i}))) \in \frac{\mathbb{C}[L_{-2}, L_{-3}, \dots]}{(L_{-2}^s)_{\partial}} \otimes_{\frac{\mathbb{C}[L_{-2}]}{(L_{-2}^s)}}\frac{\bigoplus_{k \in \mathbb{N}}\mathbb{C}[L_{-2}]L_{-1}^k}{\sigma_0(J(c_{2, 2s + 1}, h_{1, i}))}.
  \end{equation*}
  From \eqref{eq:3} and \eqref{eq:4}, we conclude that
  \begin{equation}
    \label{eq:9}
    \frac{\mathbb{C}[L_{-2}, L_{-3}, \dots]}{(L_{-2}^s)_{\partial}} \otimes_{\frac{\mathbb{C}[L_{-2}]}{(L_{-2}^s)}}\frac{\bigoplus_{k \in \mathbb{N}}\mathbb{C}[L_{-2}]L_{-1}^k}{\sigma_0(J(c_{2, 2s + 1}, h_{1, i}))} = \vspan\{t_{\lambda} \mid \lambda \in P^{s, i}\}.
  \end{equation}
  From the fact that the natural epimorphism $\phi_{L(c_{2, 2s + 1}, h_{1, i})}: JR_{\Vir_{2, 2s + 1}} \otimes_{R_{\Vir_{2, 2s + 1}}} R_{L(c_{2, 2s + 1}, h_{1, i})} \twoheadrightarrow \gr_F(L(c_{2, 2s + 1}, h_{1, i}))$ respects the grading while mapping $\{t_{\lambda} \mid \lambda \in P^{s, i}\}$ onto a basis of $\gr_F(L(c_{2, 2s + 1}, h_{1, i}))$(c.f.\ \Cref{thr:2}), the fact that $\dim((JR_{\Vir_{2, 2s + 1}} \otimes_{R_{\Vir_{2, 2s + 1}}} R_{L(c_{2, 2s + 1}, h_{1, i})})_{h_{1, i} + n})< \infty$ and $\dim(\gr_F(L(c_{2, 2s + 1}, h_{1, i}))_{h_{1, i} + n})< \infty$ for $n \in \mathbb{N}$, \Cref{prp:8} and \eqref{eq:9}, we obtain that the natural epimorphism $\phi_{L(c_{2, 2s + 1}, h_{1, i})}$ is actually an isomorphism.
  
\end{proof}

\section{Refined characters of graded algebras and their modules}
\label{sec:refin-char-algebr}

Let $A$ be a commutative associative algebra with unit $1$, and we assume the subset $S \subseteq A$ generates $A$ as an algebra, i.e., $A = \mathbb{C}[S]$.
The \emph{increasing filtration of $A$ with respect to $S$} is given by
\begin{equation*}
  A^p = \vspan\{a_1\dots a_s \mid s \le p, a_1, \dots, a_s \in S\} \quad \text{for $p \in \mathbb{Z}$}.
\end{equation*}
This filtration satisfies:
\begin{enumerate}
\item $A^p = 0$ for $p < 0$;
\item $A^0 = \mathbb{C}1$;
\item $A^0 \subseteq A^1 \subseteq \dots$;
\item $A^pA^q \subseteq A^{p + q}$ for $p, q \in \mathbb{Z}$;
\item $A = \sum_{p \in \mathbb{Z}}A^p$.
\end{enumerate}

If $A$ is $\mathbb{N}$-graded such that $\dim(A_n) < \infty$ for $n \in \mathbb{N}$, we can define \emph{the refined character of $A$ with respect to the increasing filtration of $A$ with respect to $S$} as follows
\begin{equation*}
  \ch^S_A(t, q) = \sum_{p, n \in \mathbb{N}}\dim\left(\frac{A^p \cap A_n}{A^{p - 1} \cap A_n}\right)t^pq^n \in \mathbb{C}[[t, q]].
\end{equation*}

We now assume $A$ is a differential commutative associative algebra with unit $1$ and derivation $\partial$.
The \emph{Li filtration of $A$} is given by
\begin{equation*}
  F_pA = \vspan\{(\partial^{n_1}a_1)\dots(\partial^{n_s}a_s) \mid s, n_1, \dots, n_s \in \mathbb{N}, n_1 + \dots + n_s \ge p\} \quad \text{for $p \in \mathbb{Z}$}.
\end{equation*}
This filtration satisfies:
\begin{enumerate}
\item $F_pA = A$ for $p \le 0$;
\item $F_0A \supseteq F_1A \supseteq \dots$;
\item $\partial(F_pA) \subseteq F_{p + 1}A$ for $p \in \mathbb{Z}$;
\item $(F_pA)(F_qA) \subseteq F_{p + q}A$ for $p, q \in \mathbb{Z}$.
\end{enumerate}

If $A$ is $\mathbb{N}$-graded such that $\dim(A_n) < \infty$ for $n \in \mathbb{N}$, we can define \emph{the refined character of $A$ with respect to the Li filtration of $A$} as follows
\begin{equation*}
  \ch^A_F(t, q) = \sum_{p, n \in \mathbb{N}}\dim\left(\frac{F_pA \cap A_n}{F_{p + 1}A \cap A_n}\right)t^pq^n \in \mathbb{C}[[t, q]]
\end{equation*}

We now assume $A$ is a $\mathbb{N}$-graded differential commutative associative algebra with unit $1$ and derivation $\partial$, and we assume the subset $S \subseteq A$ of homogeneous elements generates $A$ as a differential algebra, i.e., $A = (S)_{\partial}$.
The \emph{standard filtration of $A$ with respect to $S$} is given by
\begin{equation*}
  G^pA = \vspan\{(\partial^{n_1}a_1)\dots(\partial^{n_s}a_s) \mid s, n_1, \dots, n_s \in \mathbb{N}, a_1, \dots, a_s \in S, \Delta_{a_1} + \dots + \Delta_{a_s} \le p\} \quad \text{for $p \in \mathbb{Z}$}.
\end{equation*}
This filtration satisfies:
\begin{enumerate}
\item $G^pA = 0$ for $p < 0$;
\item $1 \in G^0A \subseteq G^1A \subseteq \dots$
\item $A_n \subseteq G^nA$ for $n \in \mathbb{N}$;
\item $A = \bigcup_{p \in \mathbb{N}}G^pA$;
\item $(G^pA)(G^qA) \subseteq G^{p + q}A$ for $p, q \in \mathbb{Z}$;
\item $H(G^pA) \subseteq G^pA$ and $\partial(G^pA) \subseteq G^pA$ for $p \in \mathbb{Z}$.
\end{enumerate}

If $A$ satisfies $\dim(A_n) < \infty$ for $n \in \mathbb{N}$, we can define \emph{the refined character of $A$ with respect to the standard filtration of $A$ with respect to $S$} as follows
\begin{equation*}
  \ch^G_A(t, q) = \sum_{p, n \in \mathbb{N}}\dim\left(\frac{G^pA \cap A_n}{G^{p - 1}A \cap A_n}\right)t^pq^n \in \mathbb{C}[[t, q]]
\end{equation*}

\bibliographystyle{alpha}
\bibliography{boundary-minimal-models}

\end{document}
