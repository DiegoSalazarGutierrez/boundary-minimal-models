\documentclass[a4paper, 12pt, reqno]{amsart}

\usepackage{amssymb}
\usepackage[backref = page]{hyperref}
\usepackage[margin = 0.75in]{geometry}
\usepackage[shortlabels]{enumitem}
\usepackage{tikz-cd}
\usepackage[nameinlink]{cleveref}

\newtheorem{theorem}{Theorem}[section]
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{corollary}[theorem]{Corollary}

\theoremstyle{remark}
\newtheorem{remark}[theorem]{Remark}
\newtheorem{example}[theorem]{Example}

\setenumerate[0]{label = \normalfont(\roman*)}

\DeclareMathOperator{\Vir}{Vir}
\DeclareMathOperator{\Ind}{Ind}
\DeclareMathOperator{\ch}{ch}
\DeclareMathOperator{\len}{len}
\DeclareMathOperator{\clen}{clen}
\DeclareMathOperator{\vac}{|0\rangle}
\DeclareMathOperator{\gr}{gr}
\DeclareMathOperator{\Hom}{Hom}
\DeclareMathOperator{\vspan}{span}
\DeclareMathOperator{\supp}{supp}
\DeclareMathOperator{\ad}{ad}
\DeclareMathOperator{\lp}{lp}
\DeclareMathOperator{\prt}{prt}

\renewcommand*{\backref}[1]{}
\renewcommand*{\backrefalt}[4]{%
  \ifcase #1 (Not cited.)%
  \or        (Cited on page~#2.)%
  \else      (Cited on pages~#2.)%
  \fi}

\begin{document}

\setcounter{section}{-1}

\begin{abstract}
  Some abstract. \\
  \smallskip
  \noindent \textbf{Keywords.} Some keywords.
\end{abstract}

\title{Boundary minimal models}
\author{Diego Salazar}
\address{Instituto de Matem√°tica Pura e Aplicada, Rio de Janeiro, RJ, Brazil}
\email{diego.salazar@impa.br}
\date{\today}
\maketitle

\section{Introduction}
\label{sec:introduction}

Let $s \in \mathbb{Z}_+$, let $i \in \{1, 2, \dots, s\}$, let $R^{s, i}$ denote the following set of partitions
\begin{equation*}
  R^{s, i} = \{\lambda \mid \text{$\lambda = [\lambda_1, \dots, \lambda_s]$ satisfies $\lambda_1 - \lambda_s \le 1$ or $\lambda = \underbrace{[1, 1, \dots, 1]}_i$}\},
\end{equation*}
and let $P^{s, i}$ be the set of partitions that do not contain any partition in $R^{s, i}$.

\begin{theorem}
  \label{thr:1}
  With notation as above, we have
  \begin{equation}
    \label{eq:2}
    \ch_{L(c_{2, 2s + 1}, h_{1, i})}(t, q) = J_{s, i}(0; t; q) = \sum_{k = (k_1, \dots, k_s) \in \mathbb{N}^{s - 1}}t^{kB^{(s)}_{s - 1}}\frac{q^{\frac{1}{2}kG^{(s)}k^T + kB^{(s)}_{s - i}}}{(q)_{k_1}\dots(q)_{k_{s - 1}}},
  \end{equation}
  where $T$ denotes the transpose matrix and
  \begin{align*}
    G^{(s)} &= (2\min\{i, j\})_{i, j = 1}^{s - 1}, \\
    B^{(s)}_j &=
                \left(\begin{smallmatrix}
                  0 \\
                  0 \\
                  \vdots \\
                  0 \\
                  1 \\
                  2 \\
                  \vdots \\
                  j
                \end{smallmatrix}\right) \quad \text{for $j = 0, 1, \dots, s - 1$}.  
  \end{align*}
\end{theorem}

\begin{theorem}
  \label{thr:2}
  The set
  \begin{equation*}
    \{L_{-\lambda_1}L_{-\lambda_2}\dots L_{-\lambda_m}|c_{2, 2s + 1}, h_{1, i}\rangle \mid \lambda = [\lambda_1, \dots, \lambda_m] \in R_{s, i}\}
  \end{equation*}
  is a vector space basis of $L(c_{2, 2s + 1}, h_{1, i})$. 
\end{theorem}

\begin{theorem}
  \label{thr:3}
  Need some theorem about modularity of the refined characters.
  Probably something analyzing the two modules over $\Vir_{2, 5}$ would be best to do first. 
\end{theorem}

\section{Preliminaries and notation}
\label{sec:prel-notat}

The set of natural numbers $\{0, 1, \dots\}$ is denoted by $\mathbb{N}$, the set of integers is denoted by $\mathbb{Z}$, and the set of positive integers $\{1, 2, \dots\}$ is denoted by $\mathbb{Z}_+$.

First, we review the theory of representations of the Virasoro Lie algebra following [].
The \emph{Virasoro Lie algebra} is a Lie algebra given by
\begin{equation*}
  \Vir = \bigoplus_{n \in \mathbb{Z}}\mathbb{C}L_n \oplus \mathbb{C}C.
\end{equation*}
These elements satisfy the following commutation relations:
\begin{align*}
  [L_m, L_n] &= (m - n)L_{m + n} + \delta_{m, -n}\frac{m^3 - m}{12}C \quad \text{for $m, n \in \mathbb{Z}$}, \\
  [\Vir, C] &= 0.
\end{align*}
Let $c, h \in \mathbb{C}$.
We set $\Vir_{\ge 0} = \bigoplus_{n \in \mathbb{N}}\mathbb{C}L_n$.
We make the subalgebra $\Vir_{\ge 0} \oplus \mathbb{C}C$ of $\Vir$ act on $\mathbb{C}$ as follows:
\begin{equation*}
  \text{$L_n1 = 0$ for $n \in \mathbb{Z}_+$, $L_01 = h$ and $C1 = c$}.
\end{equation*}
The \emph{Verma representation} of $\Vir$ with \emph{highest weight} $(c, h)$ is defined as
\begin{equation*}
  M(c, h) = \Ind^{\Vir}_{\Vir_{\ge 0} \oplus \mathbb{C}C}(\mathbb{C}) = U(\Vir) \otimes_{U(\Vir_{\ge 0} \oplus \mathbb{C}C)} \mathbb{C},
\end{equation*}
where $\Vir$ acts by left multiplication.
We take $|c, h\rangle = 1 \otimes 1$ as \emph{highest weight vector}.

A \emph{partition (of $n \in \mathbb{N}$)} is a sequence $\lambda = [\lambda_1, \dots, \lambda_m]$ such that $\lambda_i \in \mathbb{Z}_+$ for $i = 1, \dots, m$, $\lambda_1 \ge \dots \ge \lambda_m$ (and $\lambda_1 + \dots + \lambda_m = n$).
We also consider the \emph{empty partition} $\emptyset$, which is the unique partition of $0$.
For a partition $\lambda = [\lambda_1, \dots, \lambda_m]$, we define
\begin{equation*}
  L_{\lambda} = L_{-\lambda_1}\dots L_{-\lambda_m} \in U(\Vir).
\end{equation*}
By the PBW theorem, the set
\begin{equation*}
  \{L_{\lambda}|c, h\rangle \mid \text{$\lambda$ is a partition}\}
\end{equation*}
is a vector space basis of $M(c, h)$.
The representation $M(c, h)$ has a unique maximal proper subrepresentation $J(c, h)$, and the quotient
\begin{equation*}
  L(c, h) = M(c, h)/J(c, h)
\end{equation*}
is the \emph{irreducible highest weight representation} of $\Vir$ with highest weight $(c, h)$.

For a partition $\lambda = [\lambda_1, \dots, \lambda_m, 1, \dots, 1]$ with exactly $n$ ones, we define the \emph{length of $\lambda$} as
\begin{equation*}
  \len(\lambda) = m + n,
\end{equation*}
the \emph{conformal length of $\lambda$} as
\begin{equation*}
  \clen(\lambda) = 2m + n,
\end{equation*}
the \emph{weight of $\lambda$} as
\begin{equation*}
  \Delta(\lambda) = \lambda_1 + \dots + \lambda_m + n,
\end{equation*}
and $p_{\lambda} \in \mathbb{C}[L_{-1}, L_{-2}, \dots]$ by setting
\begin{equation*}
  p_{\lambda} = L_{-\lambda_1}\dots L_{-\lambda_m}.
\end{equation*}

A \emph{composition (of $n \in \mathbb{N}$)} is a sequence $\lambda = [\lambda_1, \dots, \lambda_m]$ such that $\lambda_i \in \mathbb{Z}_+$ for $i = 1, \dots, m$ (and $\lambda_1 + \dots + \lambda_m = n$).
We also consider the \emph{empty composition} $\emptyset$, which is the unique composition of $0$.
Given a composition $\lambda = [\lambda_1, \lambda_2, \dots, \lambda_m]$ and a permutation $\sigma \in S_m$, we define the composition
\begin{equation*}
  \lambda\sigma = [\lambda_{\sigma(1)}, \lambda_{\sigma(2)}, \dots, \lambda_{\sigma(m)}].
\end{equation*}

\section{Modules over algebras with a filtration}
\label{sec:modul-over-algebr}

Let $A$ be an associative (not necessarily commutative) algebra with unit $1$ and filtration $(A^p)_{p \in \mathbb{Z}}$ such that:
\begin{enumerate}
\item $A^p = 0$ for $p < 0$;
\item $1 \in A^0$;
\item $A^0 \subseteq A^1 \subseteq \dots$;
\item $A^pA^q \subseteq A^{p + q}$ for $p, q \in \mathbb{Z}$.
\end{enumerate}
Let
\begin{equation*}
  \gr(A) = \bigoplus_{p \in \mathbb{N}}A^p/A^{p - 1}
\end{equation*}
be the associated graded vector space.
The vector space $\gr(A)$ is an associative algebra with unit and multiplication given as follows.
For $p, q \in \mathbb{N}$, $a \in A^p$ and $b \in A^p$, we set
\begin{equation*}
  \gamma^p(a)\gamma^q(b) = \gamma^{p + q}(ab),
\end{equation*}
where $\gamma^p: A^p \to \gr(A)$ is the \emph{principal symbol map}, which is the composition of the natural maps $A^p \twoheadrightarrow A^p/A^{p - 1}$ and $A^p/A^{p - 1} \hookrightarrow \gr(A)$.
The unit of $\gr(A)$ is $\gamma^0(1)$.

Let $\partial$ be a derivation of $A$ respecting the gradation $(A^p)_{p \in \mathbb{Z}}$, i.e., it satisfies:
\begin{enumerate}
\item $\partial(ab) = \partial(a)b + a\partial(b)$ for $a, b \in A$;
\item $\partial(A^p) \subseteq A^p$ for $p \in \mathbb{Z}$.
\end{enumerate}
Then we can define
\begin{align*}
  \partial: \gr(A) &\to \gr(A), \\
  \partial(\gamma^p(a)) &= \gamma^p(\partial(a)) \quad \text{for $p \in \mathbb{Z}$ and $a \in A^p$},
\end{align*}
and it is a derivation of $\gr(A)$.

\begin{example}
  \label{exa:1}
  Let $\mathfrak{g}$ be a Lie algebra.
  The \emph{PBW filtration of $U(\mathfrak{g})$}, the universal enveloping algebra of $\mathfrak{g}$, is given by
  \begin{equation*}
    U(\mathfrak{g})^p = \vspan\{x_1x_2\dots x_s \mid s \le p, x_1, \dots, x_s \in \mathfrak{g}\} \quad \text{for $p \in \mathbb{Z}$}.
  \end{equation*}
  This filtration clearly satisfies axioms (i)--(iv) above, and $\gr(U(\mathfrak{g}))$ is naturally isomorphic to $S(\mathfrak{g})$, the symmetric algebra of $\mathfrak{g}$, which is a polynomial algebra.
  Furthermore, if $\partial$ is a derivation of $\mathfrak{g}$ as a Lie algebra, then we can extend $\partial$ to a derivation of $U(\mathfrak{g})$, and it respects the PBW filtration.
  Thus, it defines a derivation $\partial: \gr(U(\mathfrak{g})) \to \gr(U(\mathfrak{g}))$.
\end{example}

Let $M$ be an $A$-module with filtration $(M^p)_{p \in \mathbb{Z}}$ such that:
\begin{enumerate}
\item $M^p = 0$ for $p < 0$;
\item $M^0 \subseteq M^1 \subseteq \dots$;
\item $A^pM^q \subseteq M^{p + q}$ for $p, q \in \mathbb{Z}$.
\end{enumerate}
Let
\begin{equation*}
  \gr(M) = \bigoplus_{p \in \mathbb{N}}M^p/M^{p - 1}
\end{equation*}
be the associated graded vector space.

Then $\gr(M)$ is a $\gr(A)$-module with operations given as follows.
For $p, q \in \mathbb{N}$, $a \in A^p$ and $u \in M^p$, we set
\begin{equation*}
  \gamma^p(a)\gamma^q_M(u) = \gamma^{p + q}_M(au),
\end{equation*}
where $\gamma^p_M: M^p \to \gr(M)$ is the \emph{principal symbol map}, which is the composition of the natural maps $M^p \twoheadrightarrow M^p/M^{p - 1}$ and $M^p/M^{p - 1} \hookrightarrow \gr(M)$.

The category of modules over $A$ with the given filtration $(A^p)_{p \in \mathbb{Z}}$ is given by modules $M$ with a filtration $(M^p)_{p \in \mathbb{Z}}$ satisfying the conditions above.
A homomorphism $f: M \to N$ must satisfy $f(M^p) \subseteq N^p$ for $p \in \mathbb{Z}$.
This category is denoted by $A\text{-Mod}$ (the filtration being suppressed from the notation).

We can define a functor $\gr: A\text{-Mod} \to \gr(A)\text{-Mod}$ as follows.
For a homomorphism $f: M \to N$, we set
\begin{align*}
  \gr(f): \gr(M) &\to \gr(N), \\
  \gr(f)(\gamma_M^p(u)) &= \gamma_N^p(f(u)) \quad \text{for $p \in \mathbb{N}$ and $u \in M^p$}.
\end{align*}

\section{Modules over $Q$-graded Lie algebras}
\label{sec:modules-over-q}

Let $\Gamma$ be an abelian group.
For a $\Gamma$-graded vector space $V = \bigoplus_{\alpha \in \Gamma}V^{\alpha}$, we set $\supp(V) = \{\alpha \in \Gamma \mid V^{\alpha} \neq 0\}$.

A \emph{$\Gamma$-graded Lie algebra} is a Lie algebra $\mathfrak{g} = \bigoplus_{\mathfrak{g} \in \Gamma}\mathfrak{g}^{\alpha}$ such that
\begin{equation*}
  [\mathfrak{g}^{\alpha}, \mathfrak{g}^{\beta}] \subseteq \mathfrak{g}^{\alpha + \beta} \quad \text{for $\alpha, \beta \in \Gamma$}.
\end{equation*}

Let $Q$ be a free abelian group of finite rank $r$, and let $\mathfrak{g}$ be a Lie algebra with a commutative subalgebra $\mathfrak{h}$.
We say a pair $(\mathfrak{g}, \mathfrak{h})$ is a \emph{$Q$-graded Lie algebra} if it satisfies the following:
\begin{enumerate}
\item $\mathfrak{g} = \bigoplus_{\alpha \in Q}\mathfrak{g}^{\alpha}$ is $Q$-graded, $\mathfrak{h} = \mathfrak{g}^0$, and $\supp(\mathfrak{g})$ generates $Q$;
\item We have a homomorphism $\pi_Q: Q \to \mathfrak{h}^*, \alpha \mapsto \lambda_{\alpha}$ such  that
  \begin{equation*}
    [h, x] = \lambda_{\alpha}(h)x \quad \text{for $h \in \mathfrak{h}$ and $x \in \mathfrak{g}^{\alpha}$};
  \end{equation*}
\item For $\alpha \in Q$, $\dim(\mathfrak{g}^{\alpha}) < \infty$;
\item There exists a basis $(\alpha_i)_{i = 1}^r$ of $Q$ such that for $\alpha \in \supp(\mathfrak{g})$,
  \begin{equation*}
    \text{$\alpha \in \sum_{i = 1}^r\mathbb{Z}_{\ge 0}\alpha_i$ or $\alpha \in \sum_{i = 1}^r\mathbb{Z}_{\le 0}\alpha_i$}.
  \end{equation*}
\end{enumerate}

The condition (iv) implies that a $Q$-graded Lie algebra admits a \emph{triangular decomposition}.
If we set $Q^+ = \sum_{i = 1}^r\mathbb{Z}_{\ge 0}\alpha_i$ and
\begin{equation*}
  \mathfrak{g}^{\pm} = \bigoplus_{\pm \alpha \in Q^+ \setminus \{0\}}\mathfrak{g}^{\alpha},
\end{equation*}
then we have $\mathfrak{g} = \mathfrak{g}^- \oplus \mathfrak{h} \oplus \mathfrak{g}^+$.
For later use, we set $\mathfrak{g}^{\ge} = \mathfrak{h} \oplus \mathfrak{g}^+$ and $\mathfrak{g}^{\le} = \mathfrak{g}^- \oplus \mathfrak{h}$.

\begin{example}[\emph{$\Vir$ as a $\mathbb{Z}$-graded Lie algebra}]
  \label{exa:2}
  We set $Q = \mathbb{Z}$, $\mathfrak{h} = \mathbb{C}L_0 \oplus \mathbb{C}C$ and
  \begin{align*}
    \pi_Q: Q &\to \mathfrak{h}^*, \\
    \pi_Q(n) &= (L_0 \mapsto -n, C \mapsto 0) \quad \text{for $n \in \mathbb{Z}$}.
  \end{align*}
  Then $(\Vir, \mathfrak{h})$ is readily seen to be a $\mathbb{Z}$-graded Lie algebra.
  We take $1$ as the basis of $Q$, so $Q^+ = \mathbb{N}$.
  We can verify that $\ad(L_{-1})$ is a derivation of $\Vir$ satisfying $\ad(L_{-1})(\Vir^-) \subseteq \Vir^-$.
  Therefore, $\gr(\Vir^-) = \mathbb{C}[L_{-1}, L_{-2}, \dots]$ has a derivation given by $\partial(L_{-n}) = (n - 1)L_{-n - 1}$.
\end{example}

\begin{example}[kac moody]
  \label{exa:7}
  
\end{example}

Let $\Gamma$ be an abelian group, and let $\mathfrak{g} = \bigoplus_{\alpha \in \Gamma}\mathfrak{g}^{\alpha}$ be a $\Gamma$-graded Lie algebra.
A $\mathfrak{g}$-module $M = \bigoplus_{\alpha \in \Gamma}M^{\alpha}$ is \emph{$\Gamma$-graded} if
\begin{equation*}
  \mathfrak{g}^{\alpha}M^{\beta} \subseteq M^{\alpha + \beta} \quad \text{for $\alpha, \beta \in \Gamma$}.
\end{equation*}

An $\mathfrak{h}$-module $M$ is \emph{$\mathfrak{h}$-diagonalizable} if
\begin{equation*}
  M = \bigoplus_{\lambda \in \mathfrak{h}^*}M_{\lambda},
\end{equation*}
where $M_{\lambda} = \{v \in M \mid \text{for $h \in \mathfrak{h}$, $hv = \lambda(h)v$}\}$.

An $\mathfrak{h}$-diagonalizable module $M$ is called \emph{$\mathfrak{h}$-semisimple} if
\begin{equation*}
  \dim(M_{\lambda}) < \infty \quad \text{for $\lambda \in \mathfrak{h}^*$}.
\end{equation*}
A $(\mathfrak{g}, \mathfrak{h})$-module is an $\mathfrak{h}$-diagonalizable $\mathfrak{g}$-module.
From now on, we assume that $\pi_Q$ is injective.

The \emph{character of a semisimple $(\mathfrak{g}, \mathfrak{h})$-module $M$} is given by
\begin{equation*}
  \ch_M(q) = \sum_{\lambda \in \mathfrak{h}^*}\dim(M_{\lambda})q^{\lambda}.
\end{equation*}

We can regard $\mathfrak{g}$ as a $(\mathfrak{g}, \mathfrak{h})$-module via the adjoint representation and by declaring for $\lambda \in \mathfrak{h}^*$,
\begin{equation*}
  \mathfrak{g}_{\lambda} = \mathfrak{g}^{\alpha} \quad \text{if there exists $\alpha \in Q$ such that $\lambda = \pi_Q(\alpha)$}.
\end{equation*}
This construction assumes implicitly that $\pi_Q$ is injective.

The category $\mathcal{C}_{(\mathfrak{g}, \mathfrak{h})}$ is the category whose objects are $\mathfrak{h}^*$-graded $(\mathfrak{g}, \mathfrak{h})$-modules and for $M, N \in \mathcal{C}_{(\mathfrak{g}, \mathfrak{h})}$, $\Hom_{\mathcal{C}_{(\mathfrak{g}, \mathfrak{h})}}(M, N) = \Hom_{\mathfrak{g}}(M, N)$ (Lie algebra module homomorphisms).

\begin{remark}
  \label{rmk:1}
  If $f \in \Hom_{\mathfrak{g}}(M, N)$, then $f$ respects the $\mathfrak{h}^*$-grading automatically because for $u \in M$ and $h \in \mathfrak{h}$, $hf(u) = f(hu) = f(\lambda(h)u) = \lambda(h)f(u)$.
\end{remark}

We can introduce a partial order on $Q$ as follows
\begin{equation*}
  \lambda_1 \le \lambda_2 \iff \text{there exists $\gamma \in Q^+$ such that $\lambda_2 - \lambda_1 = \pi_Q(\gamma)$.}
\end{equation*}
Since $\pi_Q$ is assumed to be injective, we can abuse notation and write $\lambda_2 - \lambda_1 = \gamma \in Q$.

We now define the full subcategory $\mathcal{C}^{\lambda \ge}_{(\mathfrak{g}, \mathfrak{h})}$ by considering the objects $M \in \mathcal{C}_{(\mathfrak{g}, \mathfrak{h})}$ such that $M_{\mu} = 0$ if $\lambda \ngeq \mu$.

Let $(\mathfrak{g}, \mathfrak{h})$ be a $Q$-graded Lie algebra, let $M \in \mathcal{C}_{(\mathfrak{g}, \mathfrak{h})}$, and let $\lambda \in \mathfrak{h}^*$.
$M$ is called a \emph{highest weight module} with \emph{highest weight} $\lambda \in \mathfrak{h}^*$ if there is a nonzero vector $v \in M_{\lambda}$ such that:
\begin{enumerate}
\item $xv = 0$ for $x \in \mathfrak{g}^+$;
\item $U(\mathfrak{g}^-)v = M$.
\end{enumerate}
The vector $v$ is called a \emph{highest weight vector of $M$} and is unique up to multiplication by a nonzero scalar.

\begin{example}
  \label{exa:3}
  When considering the $\mathbb{Z}$-graded Virasoro Lie algebra $(\Vir, \mathfrak{h})$, where $\mathfrak{h} = \mathbb{C}L_0 \oplus \mathbb{C}C$, we identify $\mathfrak{h}^*$ with $\mathbb{C}^2$ as $\lambda = (c, h)$ if $\lambda(C) = c$ and $\lambda(L_0) = h$.
  We are mainly interested in the highest weight modules $M(c, h)$ and $L(c, h)$ of the Virasoro Lie algebra.
  In this case, $(c_2, n_2) \ge (c_1, n_1)$ if and only if $c_1 = c_2$ and $n_1 \ge n_2$.
  If this happens, $(c_2, n_2) - (c_1, n_1) = n_1 - n_2$.
\end{example}

\section{The refined character}
\label{sec:refined-character}

Let $(\mathfrak{g}, \mathfrak{h})$ be a $\mathbb{Z}$-graded Lie algebra, let $\lambda \in \mathfrak{h}^*$, and let $M \in \mathcal{C}^{\lambda \ge}_{(\mathfrak{g}, \mathfrak{h})}$ be a semisimple module.
The \emph{PBW filtration of $M$} is given by
\begin{equation*}
  M^p = \{au \mid q \in \mathbb{N}, \mu \le \lambda, a \in U(\mathfrak{g}^-)^q, u \in M_{\mu}, q + \lambda - \mu \le p\} \quad \text{for $p \in \mathbb{Z}$}.
\end{equation*}
This filtration clearly satisfies axioms (i)--(iii) above with $U(\mathfrak{g}^-)$ in place of $A$, and $\gr(M)$ becomes a $\gr(U(\mathfrak{g^-}))$-module.

We can define a functor $\gr: \mathcal{C}^{\lambda \ge}_{(\mathfrak{g}, \mathfrak{h})} \to \gr(U(\mathfrak{g}^-))\text{-Mod}$ as follows.
Let $M, N \in \mathcal{C}^{\lambda \ge}_{(\mathfrak{g}, \mathfrak{h})}$, and let $f: M \to N$ be a homomorphism.
Then we set
\begin{align*}
  \gr(f): \gr(M) &\to \gr(N), \\
  \gr(f)(\gamma_M^p(u)) &= \gamma_N^p(f(u)) \quad \text{for $p \in \mathbb{N}$ and $u \in M^p$}.
\end{align*}

\begin{remark}
  \label{rmk:2}
  Let $M, N \in \mathcal{C}^{\lambda \ge}_{(\mathfrak{g}, \mathfrak{h})}$, and let $f: M \to N$ be a homomorphism.
  By \Cref{rmk:1}, $f$ respects the $\mathfrak{h}^*$-grading, and this implies $f(M^p) \subseteq N^p$, so what we wrote above makes sense.
\end{remark}

\begin{example}
  \label{exa:4}
  When $M = M(c, h)$ is a Verma representation of $\Vir$, we have a natural isomorphism
  \begin{align*}
    \gr(M(c, h)) &\xrightarrow{\sim} \mathbb{C}[L_{-1}, L_{-2}, \dots] = \gr(U(\Vir^{-})) \\
    L_{\lambda}|c, h\rangle & \mapsto p_{\lambda},
  \end{align*}
  where $\lambda$ is a composition.
  Therefore, when studying $L(c, h)$, we only have to study polynomial algebras, their ideals, quotients, and modules are not really required.
\end{example}

The \emph{refined character of $M \in \mathcal{C}^{\lambda \ge}_{(\mathfrak{g}, \mathfrak{h})}$}, where $M$ is semisimple, is defined by
\begin{equation*}
  \ch_M(t, q) = \sum_{p \in \mathbb{N}}\sum_{\lambda \in \mathfrak{h}^*}\dim(\gamma^p(M^p \cap M_{\lambda}))t^pq^{\lambda},
\end{equation*}
and this is what we are interested in.
Clearly, we have $\ch_M(1, q) = \ch_M(q)$.

\begin{example}
  \label{exa:5}
  We can consider the $\mathbb{Z}$-graded Virasoro Lie algebra $(\Vir, \mathfrak{h})$.
  We are mainly interested in $M(c, h)$ and $L(c, h)$.
  For example,
  \begin{equation*}
    \ch_{M(c, h)}(t, q) = \frac{q^h}{\prod_{k \in \mathbb{Z}_+}(1 - tq^k)}.
  \end{equation*}
\end{example}

\begin{example}
  \label{exa:6}
  SINGULAR SUPPORT OF THE ISING MODEL EXAMPLE
\end{example}

\begin{proposition}
  \label{prp:4}
  We have four (conformal) weight-preserving vector space isomorphisms:
  \begin{align*}
    M(c, h) &\xrightarrow{\sim} \gr^G(M(c, h)), \\
    L_{\lambda}|c, h\rangle &\mapsto \gamma^{\len(\lambda)}(L_{\lambda}|c, h\rangle), \\
    \gr^G(M(c, h)) &\xrightarrow{\sim} \mathbb{C}[L_{-1}, L_{-2}, \dots], \\
    \gamma^{\len(\lambda)}(L_{\lambda}|c, h\rangle) &\mapsto p_{\lambda}, \\
    L(c, h) &\xrightarrow{\sim} \gr^G(L(c, h)), \\
    L_{\lambda}(|c, h\rangle + J(c, h)) &\mapsto \gamma^{\len(\lambda)}(L_{\lambda}(|c, h\rangle + J(c, h))), \\
    \gr^G(L) &\xrightarrow{\sim} \gr^G(M(c, h))/K(c, h), \\
    \gamma^{\len(\lambda)}(L_{\lambda}(|c, h\rangle + J(c, h))) &\mapsto \gamma^{\len(\lambda)}(L_{\lambda}|c, h\rangle) + K(c, h),
  \end{align*}
  where $\lambda$ is a partition.
\end{proposition}

\section{A short survey on vertex algebras}
\label{sec:short-survey-vertex}

\begin{lemma}
  \label{lmm:1}
  Let $V$ be a purely even vector space.
  We consider $s$ fields $a^1(z), \dots, a^s(z) \in \mathcal{F}(V)$, with $s \ge 2$, and let $b \in V$.
  For $l \in \mathbb{Z}$,
  \begin{equation*}
    :a^1(z)a^2(z)\dots a^s(z):_{(l)}b = \sum_{n_1, \dots, n_{s - 1} \in \mathbb{N}}\sum_{k = 0}^{s - 1}R^{l, k}_{n_1, \dots, n_{s - 1}}(a^1(z), \dots, a^s(z))b,
  \end{equation*}
  where $R^{l, k}_{n_1, \dots, n_{s - 1}}(a^1(z), \dots, a^s(z))$ is the sum of $\binom{s - 1}{k}$ terms given by
  \begin{align*}
    &R^{l, k}_{n_1, \dots, n_{s - 1}}(a^1(z), \dots, a^s(z)) = \\
    &\sum_{\substack{1 \le i_1 < \dots < i_k \le s - 1 \\ 1 \le j_1 < \dots < j_{s - 1 - k} \le s - 1 \\ \{i_1, \dots, i_k\} \cup \{j_1, \dots, j_{s - 1 - k}\} = \{1, \dots, s - 1\}}}a^{j_1}_{(-n_{j_1} - 1)}\dots a^{j_{s - 1 - k}}_{(-n_{j_{s - 1 - k}} - 1)}a^s_{(l - k - \sum_{r = 1}^k n_{i_r} + \sum_{r = 1}^{s - 1 - k}n_{j_r})}a^{i_k}_{(n_{i_k})}\dots a^{i_1}_{(n_{i_1})}.
  \end{align*}
\end{lemma}

We set:
\begin{align*}
  c_{p, q} &= 1 - \frac{6(p - q)^2}{pq} \quad \text{for $p, q \ge 2$ relatively prime integers}, \\
  h_{m, n} &= \frac{(np - mq)^2 - (p - q)^2}{4pq} \quad \text{for $0 < m < p$ and $0 < n < q$.}
\end{align*}
Then
\begin{align*}
  \ch_{L(c_{p, q}, h_{m, n})}(q) &= \frac{1}{(q)_{\infty}}\sum_{k \in \mathbb{Z}}q^{\frac{(2kpq + mq - np)^2 - (p - q)^2}{4pq}} - q^{\frac{(2kpq + mq + np)^2 - (p - q)^2}{4pq}} \\
                                 &= \frac{q^{h_{m, n}}}{(q)_{\infty}}\sum_{k \in \mathbb{Z}}q^{k^2pq + k(mq - np)}-q^{k^2pq + k(mq + np) + mn} \\
                                 &= \frac{q^{h_{m, n}}}{(q)_{\infty}}\sum_{k \in \mathbb{Z}}q^{k^2pq + k(mq - np)}-q^{(m + kp)(n + kq)}.
\end{align*}

In this article, we consider:
\begin{align*}
  p &= 2, \\
  q &= 2s + 1 \quad \text{for $s \in \mathbb{Z}_+$}.
\end{align*}
Thus, $\Vir_{2, 2s + 1}$ has $s$ modules $L(c_{2, 2s + 1}, h_{1, 1}), L(c_{2, 2s + 1}, h_{1, 2}), \dots, L(c_{2, 2s + 1}, h_{1, s})$.

\section{Proofs of the main theorems}
\label{sec:proofs-main-theorems}

In this section, we fix $s \in \mathbb{Z}_+$ and $i \in \{1, 2, \dots, s\}$.

A partition $\lambda = [\lambda_1, \dots, \lambda_m]$ \emph{contains a partition} $\eta = [\eta_1, \dots, \eta_n]$, written as $\eta \subseteq \lambda$, if $m \ge n$ and there is $i \in \mathbb{Z}_+$ such that $1 \le i \le m - n + 1$ and $[\lambda_i, \lambda_{i + 1}, \dots, \lambda_{i + n - 1}] = \eta$.

We define
\begin{equation*}
  p^{s, i}(t, q) = \sum_{\lambda \in P^{s, i}}t^{\len(\lambda)}q^{\Delta(\lambda)} \in \mathbb{C}[[t, q]],
\end{equation*}
where $P^{s, i}$ is the set of partitions that do not contain any partition in $R^{s, i}$ as defined in \Cref{sec:introduction}, i.e.,
\begin{equation*}
  P^{s, i} = \{\lambda \mid \text{for $\eta \in R^{s, i}$, $\lambda \nsupseteq \eta$}\}.
\end{equation*}

We order the PBW basis of $U(\Vir_{\le -1}) = \vspan\{L_{\lambda} \mid \text{$\lambda$ is a partition}\}$ by degree reverse lexicographic order.
Formally, for any partitions $\lambda$ and $\eta$, we define
\begin{equation*}
  L_{\lambda} \le L_{\eta}\text{ if and only if }p_{\lambda} \le p_{\eta}.
\end{equation*}
For $x \in U(\Vir_{\le -1})$ with $x \neq 0$, we may write
\begin{equation*}
  x = c_1L_{\lambda_1} + c_2L_{\lambda_2} + \dots + c_rL_{\lambda_r},
\end{equation*}
where for $1 \le i \le r$, $0 \neq c_i \in \mathbb{C}$ and $L_{\lambda_1} > L_{\lambda_2} > \dots > L_{\lambda_r}$.
We define the \emph{leading power of $x$} as $\lp(x) = L_{\lambda_1}$.
We set $\lp(0) = 0$.
Next, for a highest weight $(c, h)$, we extend the definition of $\lp$ from $U(\Vir_{\le -1})$ to $M(c, h)$ by considering the isomorphism of vector spaces $U(\Vir_{\le -1}) \xrightarrow{\sim} M(c, h), L_{\lambda} \mapsto L_{\lambda}|c, h\rangle$, where $\lambda$ is a partition.

\begin{remark}
  \label{rmk:6}
  The definition of the order in the PBW basis of $U(\Vir_{\le -1})$ was made so that for a highest weight $(c, h)$, a partition $\lambda$ and $u \in M(c, h)$, if $\lp(u) = L_{\lambda}|c, h\rangle$, then $\lp(\gamma^{\len(\lambda)}(u)) = p_{\lambda}$.
\end{remark}

\begin{lemma}
  \label{lmm:3}
  For $\lambda \in R^{s, i}$, there exists $u \in J(c_{2, 2s + 1}, h_{1, i})$ such that $\lp(u) = L_{\lambda}|c_{2, 2s + 1}, h_{1, i}\rangle$.
\end{lemma}

ORDENAR LAS PARTICIONES, partiCIONES NO, SINO LOS $L_\lambda$

\begin{proof}
  By [], the maximal proper ideal of $\Vir^{c_{2, 2s + 1}}$ is generated by a singular vector of conformal weight $2s$, denoted by $a_{2, 2s + 1}$, which has the form
  \begin{equation}
    \label{eq:8}
    a_{2, 2s + 1} = L_{-2}^s\vac + \sum_{\substack{\Delta(\mu) = 2s \\ \len(\mu) < s \\ \mu_m \ge 2}}c_{\mu}L_{\mu}\vac,
  \end{equation}
  where $c_{\mu} \in \mathbb{Q}$.
  We have two cases:
  \begin{enumerate}
  \item $\lambda = [\underbrace{a + 1, \dots, a + 1}_{s - d}, \underbrace{a, \dots, a}_d]$ for some $a \in \mathbb{Z}_+$ and $d \in \{1, \dots, s\}$.
    We set
    \begin{equation*}
      u = (a_{2, 2s + 1})_{(s - sa + d - 1)}|c_{2, 2s + 1}, h_{1, i}\rangle
    \end{equation*}
    and claim
    \begin{equation}
      \label{eq:7}
      \lp(u) = L_{\lambda}|c_{2, 2s + 1}, h_{1, i}\rangle.
    \end{equation}
    To prove this, we prove first that
    \begin{equation}
      \label{eq:6}
      (L_{-2}^s\vac)_{(s - sa + d - 1)}|c_{2, 2s + 1}, h_{1, i}\rangle = \binom{s}{k}L_{\lambda}|c_{2, 2s + 1}, h_{1, i}\rangle + \sum_{\substack{\mu \neq \lambda \\ \Delta(\mu) = \Delta(\lambda) \\ \len(\mu) \le \len(\lambda)}}c_{\mu}L_{\mu}|c_{2, 2s + 1}, h_{1, i}\rangle,
    \end{equation}
    where $c_{\mu} \in \mathbb{Q}$.
    Applying \Cref{lmm:1} and [] with
    \begin{align*}
      a^1(z) = \dots = a^s(z) &= L(z) = \sum_{n \in \mathbb{Z}}L_(n)z^{-n - 1} = \sum_{n \in \mathbb{Z}}L_nz^{-n - 2}, \\
      b &= |c_{2, 2s + 1}, h_{1, i}\rangle, \\
      l &= s - sa + d - 1,
    \end{align*}
    we obtain
    \begin{equation}
      \label{eq:5}
      (L_{-2}^s\vac)_{(s - sa + d - 1)}|c_{2, 2s + 1}, h_{1, i}\rangle = \sum_{n_1, \dots, n_{s - 1} \in \mathbb{N}}\sum_{k = 0}^{s - 1}R^{s - sa + d - 1, k}_{n_1, \dots, n_{s - 1}}(L(z), \dots, L(z))|c_{2, 2s + 1}, h_{1, i}\rangle,
    \end{equation}
    where $R^{s - sa + d - 1, k}_{n_1, \dots, n_{s - 1}}(L(z), \dots, L(z))$ is the sum of $\binom{s - 1}{k}$ terms given by
    \begin{align*}
      &R^{s - sa + d - 1, k}_{n_1, \dots, n_{s - 1}}(L(z), \dots, L(z)) = \\
      &\sum_{\substack{1 \le i_1 < \dots < i_k \le s - 1 \\ 1 \le j_1 < \dots < j_{s - 1 - k} \le s - 1 \\ \{i_1, \dots, i_k\} \cup \{j_1, \dots, j_{s - 1 - k}\} = \{1, \dots, s - 1\}}}L_{-n_{j_1} - 2}\dots L_{-n_{j_{s - 1 - k}} - 2}L_{s - sa + d - 2 - k - \sum_{r = 1}^k n_{i_r} + \sum_{r = 1}^{s - 1 - k}n_{j_r}}L_{n_{i_k} - 1}\dots L_{n_{i_1} -1}.
    \end{align*}
    We see that each term $L_{\mu}$ appearing in $R^{s - sa + d - 1, k}_{n_1, \dots, n_{s - 1}}(L(z), \dots, L(z))$, where $\mu$ is a combination (not necessarily a partition), satisfies $\Delta(\mu) = sa + s - d = \Delta(\lambda)$ and $\len(\mu) \le \len(\lambda)$.
    
    We recall that $L_{(n)} = L_{n - 1}$ for $n \in \mathbb{Z}$ and $L_{\lambda} - L_{\lambda\sigma} \in U(\Vir^{-})^{\len(\lambda) - 1}$ for a combination $\lambda$ and a permutation $\sigma \in S_m$, see [].    
    Therefore, for a combination $\mu$, we can expand $L_{\mu}|c_{2, 2s + 1}, h_{1, i}\rangle$ in the following way
    \begin{equation*}
      L_{\mu}|c_{2, 2s + 1}, h_{1, i}\rangle = L_{\prt(\mu)}|c_{2, 2s + 1}, h_{1, i}\rangle + \sum_{\substack{\Delta(\mu) = \Delta(\lambda) \\ \len(\mu) < \len(\lambda)}}c_{\mu}L_{\mu}|c_{2, 2s + 1}, h_{1, i}\rangle,
    \end{equation*}
    where $c_{\mu} \in \mathbb{Q}$.
    We need to compute the coefficient of $L_{\lambda}|c_{2, 2s + 1}, h_{1, i}\rangle$ in $u$.
    To do this, we need to see how much each sum $R^{s - sa + d - 1, k}_{n_1, \dots, n_{s - 1}}(L(z), \dots, L(z))|c_{2, 2s + 1}, h_{1, i}\rangle$ contributes to the coefficient of $L_{\lambda}|c_{2, 2s + 1}, h_{1, i}\rangle$ in $u$
    We have two subcases:
    \begin{description}[leftmargin = !]
    \item[Subcase $a = 1$] In the sum \eqref{eq:5}, if $k > d$ or $k < d - 1$ or $n_i \neq 0$ for some $i = 1, \dots, s - 1$, then $R^{2s - sa - s + d - 1, k}_{n_1, \dots, n_{s - 1}}(L(z), \dots, L(z))|c_{2, 2s + 1}, h_{1, i}\rangle$ contributes $0$.
      The sum $R^{s - sa + d - 1, d - 1}_{0, \dots, 0}(L(z), \dots, L(z))|c_{2, 2s + 1}, h_{1, i}\rangle$ contributes $\binom{s - 1}{d - 1}$ and the sum $R^{s - sa + d - 1, d}_{0, \dots, 0}(L(z), \dots, L(z))|c_{2, 2s + 1}, h_{1, i}\rangle$ contributes $\binom{s - 1}{d}$.
      Since $\binom{s - 1}{d - 1} + \binom{s - 1}{d} = \binom{s}{d}$, we obtain \eqref{eq:6}.
    \item[Subcase $a > 1$] In the sum \eqref{eq:5}, if $k > 0$, then $R^{s - sa + d - 1, k}_{n_1, \dots, n_{s - 1}}(L(z), \dots, L(z))|c_{2, 2s + 1}, h_{1, i}\rangle$ contributes $0$.
      We have
      \begin{equation*}
        R^{s - sa + d - 1, 0}_{n_1, \dots, n_{s - 1}}(L(z), \dots, L(z)) = L_{-n_1 - 2}\dots L_{-n_{s - 1} - 2}L_{s - sa + d - 2 + \sum_{r = 1}^{s - 1}n_r}.
      \end{equation*}
      Therefore, the sum $R^{s - sa + d - 1, 0}_{n_1, \dots, n_{s - 1}}(L(z), \dots, L(z))|c_{2, 2s + 1}, h_{1, i}\rangle$ contributes $\binom{s - 1}{d}$ when exactly $d - 1$ of the $n_i$s are equal to $a - 2$ and $s - d$ of the $n_i$s are equal to $a - 1$, contributes $\binom{s - 1}{d}$ when exactly $d$ of the $n_i$s are equal to $a - 2$ and $s - d - 1$ of the $n_i$s are equal to $a - 1$, and contributes $0$ otherwise.
      Since $\binom{s - 1}{d - 1} + \binom{s - 1}{d} = \binom{s}{d}$, we obtain \eqref{eq:6}.
    \end{description}
  \item $\lambda = [1, 1, \dots, 1]$.
    This follows from [].
  \end{enumerate}
  We note that if $\mu$ is a partition such that $\mu \neq \lambda$, $\Delta(\mu) = \Delta(\lambda)$ and $\len(\mu) \le \len(\lambda)$, then $L_{\lambda} > L_{\mu}$.
  Thus, \eqref{eq:6} implies $\lp((L_{-2}^s\vac)_{(s - sa + d - 1)}|c_{2, 2s + 1}, h_{1, i}\rangle) = L_{\lambda}|c_{2, 2s + 1}, h_{1, i}\rangle$.
  From \eqref{eq:8} and \Cref{lmm:1}, we see that $\lp(u) = \lp((L_{-2}^s\vac)_{(s - sa + d - 1)}|c_{2, 2s + 1}, h_{1, i}\rangle) = L_{\lambda}|c_{2, 2s + 1}, h_{1, i}\rangle$.
\end{proof}

MAYBE REORDER THE LEMMAS, IDK

\begin{lemma}
  \label{lmm:5}
  We have
  \begin{equation*}
    p^{s, i}(t, q) = J_{s, i}(0, t, q) = \sum_{k = (k_1, \dots, k_s) \in \mathbb{N}^{s - 1}}t^{kB^{(s)}_{s - 1}}\frac{q^{\frac{1}{2}kG^{(s)}k^T + kB^{(s)}_{s - i}}}{(q)_{k_1}\dots(q)_{k_{s - 1}}}.
  \end{equation*}
\end{lemma}

\begin{proof}
  Following the notation of [], we write
  \begin{align*}
    p^{s, i}(t, q) &= \sum_{m = 0}^{\infty}\sum_{n = 0}^{\infty}b_{s, i}(m, n)t^mq^n, \\
    J_{s, i}(0; t; q) &= \sum_{m = 0}^{\infty}\sum_{n = 0}^{\infty}c_{s, i}(m, n)t^mq^n.
  \end{align*}
  By [], we have $b_{s, i}(m, n) = c_{s, i}(m, n)$ for $m, n \in \mathbb{N}$.
  This means $p^{s, i}(t, q) = J_{s, i}(0, t, q)$.

  By the proof of [], we have
  \begin{equation*}
    J_{s, i}(0, t, q) = \sum_{k = (k_1, \dots, k_s) \in \mathbb{N}^{s - 1}}\frac{t^{N_1 + N_2 + \dots + N_{s - 1}}q^{N_1^2 + N_2^2 + \dots + N_{s - 1}^2 + N_i + N_{i + 1} + \dots + N_{s - 1}}}{(q)_{k_1}(q)_{k_2}\dots(q)_{k_{s - 1}}},
  \end{equation*}
  where $N_j = k_j + k_{j + 1} + \dots + k_{s - 1}$ for $j = 0, 1, \dots, s - 1$.
  Since
  \begin{align*}
  N_1^2 + \dots + N_{s - 1}^2 &= \frac{1}{2}kG^{(s)}k^T, \\
  N_j + \dots + N_{s - 1} &= kB^{(s)}_{j} \quad \text{for $j = 0, 1, \dots, s - 1$},
  \end{align*}
  we have
  \begin{equation*}
    \sum_{k = (k_1, \dots, k_s) \in \mathbb{N}^{s - 1}}\frac{t^{N_1 + N_2 + \dots + N_{s - 1}}q^{N_1^2 + N_2^2 + \dots + N_{s - 1}^2 + N_i + N_{i + 1} + \dots + N_{s - 1}}}{(q)_{k_1}(q)_{k_2}\dots(q)_{k_{s - 1}}} = \sum_{k = (k_1, \dots, k_s) \in \mathbb{N}^{s - 1}}t^{kB^{(s)}_{s - 1}}\frac{q^{\frac{1}{2}kG^{(s)}k^T + kB^{(s)}_{s - i}}}{(q)_{k_1}\dots(q)_{k_{s - 1}}}.
  \end{equation*}
\end{proof}

\begin{lemma}
  \label{lmm:4}
  We have
  \begin{equation*}
    \ch_{L(c_{2, 2s + 1}, h_{1, i})}(q) = q^{h_{1, i}}p^{s, i}(1, q) = q^{h_{1, i}}\prod.
  \end{equation*}
\end{lemma}

\begin{proof}
  By \Cref{lmm:5}, [] and [], we have
  \begin{align*}
    q^{h_{1, i}}p^{s, i}(1, q) &= q^{h_{1, i}}J_{s, i}(0, 1, q) \\
    &= q^{h_{1, i}}\prod \\
    &= \frac{q^{h_{1, i}}}{(q)_{\infty}}\sum_{k \in \mathbb{N}}(-1)^kq^{(2s + 1)k(k + 1)/2 - ki}(1 - q^{(2k + 1)i}) \\
    &= \frac{q^{h_{1, i}}}{(q)_{\infty}}\sum_{k \in \mathbb{Z}}(-1)^kq^{(2s + 1)k(k + 1)/2 - ki}.
  \end{align*}
  The disjoint union $\mathbb{Z} = \{2k \mid k \in \mathbb{Z}\} \cup \{-2k - 1 \mid k \in \mathbb{Z}\}$ and () imply that
  \begin{align*}
    \frac{q^{h_{1, i}}}{(q)_{\infty}}\sum_{k \in \mathbb{Z}}(-1)^kq^{(2s + 1)k(k + 1)/2 - ki} &= \frac{q^{h_{1, i}}}{(q)_{\infty}}(\sum_{k \in \mathbb{Z}}(-1)^{2k}q^{(2s + 1)2k(2k + 1)/2 - ki} + \sum_{k \in \mathbb{Z}}(-1)^{-2k - 1}q^{(2s + 1)(-2k - 1)(-2k - 1 + 1)/2 - 2ki}) \\
    &= \frac{q^{h_{1, i}}}{(q)_{\infty}}(\sum_{k \in \mathbb{Z}}q^{(2s + 1)k(2k + 1) - ki} - \sum_{k \in \mathbb{Z}}q^{(2s + 1)(2k + 1)(k + 1) + (2k + 1)i}) \\
    &= \ch_{L(c_{2, 2s + 1}, h_{1, i})}(q). \qedhere
  \end{align*}
  
\end{proof}

\begin{proof}
  The proof is most likely Jacobi's triple product identity.
  Consider 2n y -2n-1.
\end{proof}

\begin{remark}
  \label{rmk:9}
  For any partitions $\lambda$ and $\eta$, if $\lambda \supseteq \eta$, then $p_{\eta} \mid p_{\lambda}$.
  The converse is not true.
  For example, $p_{[4, 2]} \mid p_{[4, 3, 2]}$, but $[4, 3, 2] \nsupseteq [4, 2]$.
  However, if $\eta_1 - \eta_m \le 1$, then $\lambda \supseteq \eta$ if and only if $u_{\eta} \mid u_{\lambda}$.
\end{remark}

\begin{lemma}
  \label{lmm:11}
  There is an alternative description for $P$, namely
  \begin{equation*}
    P^{s, i} = \{\lambda \mid \text{for $\eta \in R^{s, i}$, $p_{\eta} \nmid p_{\lambda}$}\}.
  \end{equation*}
\end{lemma}

\begin{proof}
  This is a corollary of \Cref{rmk:9}.
\end{proof}

\begin{proof}[Proof of \Cref{thr:2}]
  This follows from Grobner basis theory, \Cref{prp:4}, \Cref{lmm:4}, \Cref{lmm:11}, \Cref{rmk:6} and \Cref{lmm:3}, see [] for details.
\end{proof}

\begin{proof}[Proof of \Cref{thr:1}]
  This is a corollary of \Cref{thr:2}, see [] for details.
\end{proof}

====================================================

\section{Context, work done by Andrews and what we are trying to calculate}
\label{sec:context-work-done}

In this section and the following ones, we explain what we are trying to calculate, what was done by Andrews and show the difference between the vertex algebra module approach and the Lie algebra module approach.

Note that in the case $i = 1$, we have $h_{1, 1} = 0$, and we are in the vertex algebra case $L(c_{2, 2s + 1}, 0) = \Vir_{c_{2, 2s + 1}}$.
This case is studied in the book ``The theory of partitions'', as we now show.
We first recall that $R_{\Vir^{2, 2s + 1}} = \mathbb{C}[L_{-2}]$.
We know that $\Vir_{2, 2s + 1}$ is classically free, and $R_{\Vir_{2, 2s + 1}} = \mathbb{C}[L_{-2}]/(L_{-2}^s)$ because the maximal ideal of $\Vir^{2, 2s + 1}$ is generated by an element with leading monomial $L_{-2}^s\vac$ in the degree reverse lexicographical order with $L_{-2} > L_{-3} > \dots$, which is the term order we always use.

Thus, we have 
\begin{equation*}
  JR_{\Vir_{2, 2s + 1}}/(L_{-2}^s)_{\partial} = \mathbb{C}[L_{-2}, L_{-3}, \dots]/(L_{-2}^s)_{\partial}.
\end{equation*}

The leading term ideal of $(L_{-2}^s)_{\partial}$ in $\mathbb{C}[L_{-2}, L_{-3}, \dots]$ is generated by the polynomials $L_{-\lambda_1} \dots L_{-\lambda_m} \in \mathbb{C}[L_{-2}, L_{-3}, \dots]$, where $\lambda = [\lambda_1, \dots, \lambda_m]$ is a partition satisfying $\lambda_m \ge 2$ and the difference condition
\begin{equation}
  \label{eq:3}
  \lambda_i - \lambda_{i + s - 1} \le 1 \quad \text{for some $i$ with $1 \le i \le m + 1 - s$}.
\end{equation}
Therefore, by Grobner basis theory, a basis of $JR_{\Vir_{2, 2s + 1}}/(L_{-2}^s)_{\partial}$ is given by classes of polynomials $L_{-\lambda_1} \dots L_{-\lambda_m} \in \mathbb{C}[L_{-2}, L_{-3}, \dots]$, where $\lambda = [\lambda_1, \dots, \lambda_m]$ is a partition satisfying $\lambda_m \ge 2$ and the difference condition
\begin{equation}
  \label{eq:4}
  \lambda_i - \lambda_{i + s - 1} \ge 2 \quad \text{for $1 \le i \le m + 1 - s$}.
\end{equation}
NOTE 5: Actually, this is handwaving a little bit because strictly speaking, Grobner basis theory only applies to finitely generated polynomial algebras.
But we can make this rigorous by studying $\mathbb{C}[L_{-2}, L_{-3}, \dots, L_{-N}]$ and then letting $N \to \infty$.

In Theorem 7.5 of The theory of partitions, the number of partitions $\lambda$ of $n$ satisfying $\lambda_m \ge 2$ and \eqref{eq:4} is denoted by $B_{s, 1}$ (note that we are changing $k$ to $s$ here and setting $i = 1$).
In that section, it is also defined by $b_{s, 1}(m, n)$ the number of partitions $\lambda$ of $n$ with exactly $m$ parts satisfying $\lambda_m \ge 2$ and \eqref{eq:4}.
It is also noted that $b_{s, 1}(m, n) = c_{s, 1}(m, n)$, where
\begin{equation*}
  J_{s, 1}(0; t; q) = \sum_{m = 0}^{\infty}\sum_{n = 0}^{\infty}c_{s, 1}(m, n)t^mq^n,
\end{equation*}
and we have changed $x$ to $t$.

Note that, using the notation of Theorem 7.8 and the previous section, we have
\begin{align*}
  N_1^2 + \dots + N_{s - 1}^2 &= \frac{1}{2}kG^{(s)}k^T, \\
  N_1 + \dots + N_{s - 1} &= kB^{(s)}_{s - 1},
\end{align*}
where we have replaced $k$ by $s$.
By (the proof of) Theorem 7.8, we have
\begin{equation*}
  J_{s, 0}(0; t; q) = \sum_{k = (k_1, \dots, k_s) \in \mathbb{N}^{s - 1}}t^{kB^{(s)}_{s - 1}}\frac{q^{\frac{1}{2}kG^{(s)}k^T + kB^{(s)}_{s - 1}}}{(q)_{k_1}\dots(q)_{k_{s - 1}}}.
\end{equation*}

From the natural isomorphisms
\begin{align*}
  JR_{\Vir_{2, 2s + 1}}/(L_{-2}^s)_{\partial} &\cong \gr_F(\Vir_{2, 2s + 1}), \\
  \gr_F(\Vir_{2, 2s + 1}) &\cong \Vir_{2, 2s + 1},
\end{align*}
we have that a basis of $\Vir_{2, 2s + 1}$ is given by the classes of elements of the form $L_{-\lambda_1}\dots L_{-\lambda_m}\vac$, where $\lambda$ is a partition satisfying $\lambda_m \ge 2$ and \eqref{eq:4}.

In conclusion, the refined character of $\Vir_{2, 2s + 1}$ is given by 
\begin{align*}
  \ch_{\Vir_{2, 2s + 1}}(t, q) &= \sum_{m = 0}^{\infty}\sum_{n = 0}^{\infty}b_{s, 1}(m, n)t^mq^n = \sum_{m = 0}^{\infty}\sum_{n = 0}^{\infty}c_{s, 1}(m, n)t^mq^n \\
                               &= J_{s, 1}(0; t; q) = \sum_{k = (k_1, \dots, k_s) \in \mathbb{N}^{s - 1}}t^{kB^{(s)}_{s - 1}}\frac{q^{\frac{1}{2}kG^{(s)}k^T + kB^{(s)}_{s - 1}}}{(q)_{k_1}\dots(q)_{k_{s - 1}}},
\end{align*}
and this is precisely the formula in the previous section with $i = 1$.

NOTE 6: I'm not sure we can use other values of $i$ other than $i = 1$.
But probably, we can.

VERY IMPORTANT NOTE: We have not calculated the refined character with respect to the standard filtration $G^p\Vir_{2, 2s + 1}$ because there is a missing factor $2$ coming from the conformal weight of $L_{-2}\vac$ being $2$.
Sure, we could simply add it here and put $t^{2kB^{(s)}}$ instead of $t^{kB^{(s)}}$.
But the situation is different when we deal with modules because in that case $L_{-1}$ has length $1$ while $L_{-2}, L_{-3}, \dots$ have length $2$, and then the resulting character is probably not given by simply multiplying by $2$ or other trivial operation.
Thus, we had to truly define properly the meaning of the refined character in the case of $\Vir$-modules.
Sadly, if we do it like this, this does not have much to do with modules over vertex algebras and probably we can't study classically free modules over vertex algebras (or some concepts related to that).
But we might be able to go from the formula for the refined character with all lengths equal to the formula for the refined character with respect to the standard filtration.
But when I tried calculating the refined characters using the standard filtration, I could not find a closed formula.
And the results in Andrew's book probably don't help much if we use the standard filtration of modules over vertex algebras.

\section{Conjecture 2}
\label{sec:conjecture-2}

In this section, we fix $s \in \mathbb{Z}_+$ and pick any $i = 1, 2, \dots, s$.
Let $\pi: M(c_{2, 2s + 1}, h_{1, i}) \twoheadrightarrow L(c_{2, 2s + 1}, h_{1, i})$ be the natural quotient map with kernel $J(c_{2, 2s + 1}, h_{1, i})$, the maximal submodule of $M(c_{2, 2s + 1}, h_{1, i})$.
We apply the functor $\gr$, obtaining an epimorphism $\gr(\pi): \gr(M(c_{2, 2s + 1}, h_{1, i})) \twoheadrightarrow \gr(L(c_{2, 2s + 1}, h_{1, i}))$.
We wish to compute a Grobner basis of $\ker(\gr(\pi))$.

From the data, we have the following conjecture: For $s \in \mathbb{Z}_+$ and $i = 1, 2, \dots, s$, the leading term ideal of $\ker(\gr(\pi))$ is generated by the polynomials $L_{-\lambda_1} \dots L_{-\lambda_m}$ where $\lambda = [\lambda_1, \dots, \lambda_m]$ is a partition satisfying \eqref{eq:3} and the exceptional partition $\underbrace{[1, 1, \dots, 1]}_i$.

NOTE 7: We do not require the partitions to end in something greater than or equal to $2$ and for $i = 1$, this coincides with the leading term ideal of $(L_{-2}^s)_{\partial}$ of the previous section.

NOTE 8: In the case $i = s$, we can ignore the partition $\underbrace{[1, 1, \dots, 1]}_s$ because it is already included in \eqref{eq:3}.

NOTE 9: By the articles ``Singular vectors over the Virasoro algebra and extended Verma modules'' and ``Asymptotics for singular vectors in Verma
modules over the Virasoro algebra'', we have the desired partition $\underbrace{[1, 1, \dots, 1]}_i$ for all $i = 1, 2, \dots, s$ as a leading term, so we are almost finished.

NOTE 10: It seems Conjecture 1 is correct, however it is unnecessarily complicated.
In fact, Conjecture 2 and section 7.3 of Andrew's book (specifically Theorem 7.5 and the proof of Theorem 7.8) would imply that for $i = 1, 2, \dots, s$,
\begin{align*}
  \ch_{L(c_{2, 2s + 1}, h_{1, i})}(t, q) &= \sum_{m = 0}^{\infty}\sum_{n = 0}^{\infty}b_{s, i}(m, n)t^mq^n = \sum_{m = 0}^{\infty}\sum_{n = 0}^{\infty}c_{s, i}(m, n)t^mq^n \\
                                         &= J_{s, i}(0; t; q) = \sum_{k = (k_1, \dots, k_s) \in \mathbb{N}^{s - 1}}t^{kB^{(s)}_{s - 1}}\frac{q^{\frac{1}{2}kG^{(s)}k^T + kB^{(s)}_{s - i}}}{(q)_{k_1}\dots(q)_{k_{s - 1}}}.
\end{align*}

NOTE 11: To prove Conjecture 2, it remains to show the following.
\begin{lemma}
  \label{lmm:2}
  Let $s \in \mathbb{Z}_+$, and we pick any $i = 1, 2, \dots, s$.
  For a partition $\lambda$ of length $p$ satisfying \eqref{eq:3}, there $u \in J(c_{2, 2s + 1}, h_{1, i}) \cap M(c_{2, 2s + 1}, h_{1, i})^p$ such that $\lp(u) = L_{\lambda}|c_{2, 2s + 1}, h_{1, i}\rangle$.
\end{lemma}

\begin{proof}[sketch of proof]
  We should use the fact that the following diagram commutes
  \begin{equation*}
    \begin{tikzcd}
      \Vir^c \arrow[r, two heads] \arrow[rd, "{Y^{L(c, h_{m, n})}_{\Vir^c}}"'] & {\Vir_c} \arrow[d, "{Y^{L(c, h_{m, n})}_{\Vir_c}}"] \\
      & {\mathcal{F}(L(c, h_{m, n}))}
    \end{tikzcd}
  \end{equation*}
  This is because we are studying precisely the modules over $\Vir_{2, 2s + 1}$.
  It is also nice to start using vertex algebra theory.

  That diagram implies the following statement
  \begin{equation*}
    \text{for $a \in U(\Vir)\{a_{2, 2s + 1}\}$, $a_{(-1)}|c_{2, 2s + 1}, h_{1, i}\rangle \in J(c_{2, 2s + 1}, h_{1, i})$},
  \end{equation*}
  where $a_{2, 2s + 1}$ denotes the singular vector of $\Vir^{2, 2s + 1}$ generating $J(c_{2, 2s + 1}, 0)$.

  This statement together with the following observation would almost imply Lemma 1.
  For $c, h \in \mathbb{C}$ and a partition $\lambda = [\lambda_1, \dots, \lambda_m]$ with $\lambda_m \ge 2$,
  \begin{equation*}
    (L_{\lambda}\vac)_{(-1)}|c, h\rangle = L_{\lambda}|c, h\rangle + \text{(lower order terms)}.
  \end{equation*}
  By lower order terms, we mean that we are using the degree reverse lexicographic order with $L_{-1} > L_{-2} > \dots$.
  I wrote ``almost'' because this does not include any partitions with ones.
  I am not sure how to overcome this obstacle.

  Actually, I think what is correct is that
  \begin{equation*}
    (L_{\lambda}\vac)_{(-1)}|c, h\rangle = L_{\lambda}|c, h\rangle + \sum_{\substack{\Delta(\mu) = \Delta(\lambda) \\ \len(\mu) \le \len(\lambda) \\ \clen(\mu) < \clen(\lambda)}}c_{\mu}L_{\mu}|c, h\rangle.
  \end{equation*}
  The partitions with ones have to be dealt separately.
\end{proof}

\end{document}
